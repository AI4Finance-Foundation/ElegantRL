import isaacgym
import torch
import sys
import wandb
from elegantrl.train.run import train_and_evaluate, train_and_evaluate_mp
from elegantrl.train.config import Arguments
from elegantrl.agents.AgentPPO import AgentPPO
from elegantrl.agents.AgentTD3 import AgentTD3
from elegantrl.agents.AgentSAC import AgentSAC, AgentReSAC
from elegantrl.envs.IsaacGymEnv import IsaacVecEnv, IsaacOneEnv

'''[ElegantRL.2022.05.05](github.com/AI4Fiance-Foundation/ElegantRL)'''


# export LD_LIBRARY_PATH=/xfs/home/podracer_steven/anaconda3/envs/rlgpu/lib

def demo_ppo(gpu_id, drl_id, env_id):
    env_name = ['Ant',
                'Humanoid',
                'ShadowHand'][env_id]
    agent_class = [AgentPPO, ][drl_id]

    if env_name == 'Ant':
        env_func = IsaacVecEnv
        env_args = {
            'env_num': 1024,
            'env_name': 'Ant',
            'max_step': 1000,
            'state_dim': 60,
            'action_dim': 8,
            'if_discrete': False,
            'target_return': 15000.,

            'sim_device_id': gpu_id,
            'rl_device_id': gpu_id,
        }
        args = Arguments(agent_class, env_func=env_func, env_args=env_args)
        args.eval_env_func = IsaacOneEnv
        args.eval_env_args = {
            'env_num': 1,
            'env_name': 'Ant',
            'max_step': 1000,
            'state_dim': 60,
            'action_dim': 8,
            'if_discrete': False,
            'target_return': 15000.,

            'device_id': gpu_id,
        }

        args.target_step = args.max_step
        args.reward_scale = 2 ** -4
        args.worker_num = 1

        args.if_use_gae = True
        args.if_cri_target = False
        args.if_use_old_traj = False

        args.learning_rate = 2 ** -15

        if gpu_id == 3:
            args.repeat_times = 2 ** 4
            args.net_dim = 2 ** 9
            args.batch_size = args.net_dim
        if gpu_id == 4:
            args.repeat_times = 2 ** 5
            args.net_dim = 2 ** 9
            args.batch_size = args.net_dim * 2
        if gpu_id == 5:
            args.repeat_times = 2 ** 4
            args.net_dim = 2 ** 8
            args.batch_size = args.net_dim * 2
        if gpu_id == 6:
            args.repeat_times = 2 ** 6
            args.net_dim = 2 ** 8
            args.batch_size = args.net_dim * 8

        args.gamma = 0.985
        args.lambda_gae_adv = 0.85
        args.lambda_entropy = 2 ** -12

        args.eval_gap = 2 ** 9
        args.eval_times = 2 ** 1
        args.max_step = int(6e7)
    elif env_name == 'Ant.12330 args.if_use_old_traj = False':
        env_func = IsaacVecEnv
        env_args = {
            'env_num': 1024,
            'env_name': 'Ant',
            'max_step': 1000,
            'state_dim': 60,
            'action_dim': 8,
            'if_discrete': False,
            'target_return': 15000.,

            'sim_device_id': gpu_id,
            'rl_device_id': gpu_id,
        }
        args = Arguments(agent_class, env_func=env_func, env_args=env_args)
        args.eval_env_func = IsaacOneEnv
        args.eval_env_args = {
            'env_num': 1,
            'env_name': 'Ant',
            'max_step': 1000,
            'state_dim': 60,
            'action_dim': 8,
            'if_discrete': False,
            'target_return': 15000.,

            'device_id': gpu_id,
        }

        args.reward_scale = 2 ** -4  # todo plan to be 2 ** -6 and learning_rate = 2 ** -14
        args.if_cri_target = False

        args.net_dim = 2 ** 8
        args.batch_size = args.net_dim * 4
        args.repeat_times = 2 ** 4
        args.gamma = 0.985
        args.if_use_gae = True
        args.learning_rate = 2 ** -15

        args.target_step = args.max_step
        args.batch_size = args.net_dim * 4
        args.worker_num = 1

        args.if_use_old_traj = False  # todo
        args.lambda_gae_adv = 0.85

        args.lambda_entropy = 2 ** -14  # 2 ** -10

        args.eval_gap = 2 ** 9
        args.eval_times = 2 ** 1
        args.max_step = int(6e7)
        """
        ################################################################################
ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
[Error] [carb.windowing-glfw.plugin] GLFW initialization failed.
[Error] [carb.windowing-glfw.plugin] GLFW window creation failed!
[Error] [carb.gym.plugin] Failed to create Window in CreateGymViewerInternal
5  1.45e+06  715.30 |
5  1.45e+06  715.30 |  715.30    0.8    999     0 |    0.03   0.65  -0.00   0.00
5  5.25e+06  813.08 |
5  5.25e+06  813.08 |  813.08    1.5    999     0 |    0.07   0.71   0.07   0.00
5  8.94e+06 1509.14 |
5  8.94e+06 1509.14 | 1509.14 1221.1    600   400 |    0.12   1.01   0.05   0.00
5  1.26e+07 3632.72 |
5  1.26e+07 3632.72 | 3632.72  464.7    904    95 |    0.16   1.34   0.01   0.00
5  1.61e+07 4859.70 |
5  1.61e+07 4859.70 | 4859.70   41.7    999     0 |    0.21   1.88   0.02   0.00
5  1.94e+07 5700.69 |
5  1.94e+07 5700.69 | 5700.69  402.1    999     0 |    0.26   2.32  -0.01   0.00
5  2.27e+07 6393.19 |
5  2.27e+07 6393.19 | 6393.19  363.5    999     0 |    0.30   2.53  -0.00   0.00
5  2.59e+07 6393.19 | 5507.23 1342.6    844   155 |    0.33   2.72   0.04   0.00
5  2.92e+07 6393.19 | 4640.38    0.0    717     0 |    0.36   3.01   0.06   0.00
5  3.29e+07 7456.53 |
5  3.29e+07 7456.53 | 7456.53  367.6    999     0 |    0.39   3.08   0.04   0.00
5  3.67e+07 7895.77 |
5  3.67e+07 7895.77 | 7895.77   23.8    999     0 |    0.41   3.70  -0.01   0.00
5  3.99e+07 7895.77 | 7537.12    0.0    999     0 |    0.43   3.43   0.02   0.00
5  4.36e+07 8044.43 |
5  4.36e+07 8044.43 | 8044.43   91.3    999     0 |    0.45   4.14   0.05   0.00
5  4.72e+07 8555.77 |
5  4.72e+07 8555.77 | 8555.77   43.7    999     0 |    0.47   3.70   0.11   0.00
5  5.09e+07 8555.77 | 8500.93    0.0    999     0 |    0.48   3.66   0.05   0.00
5  5.46e+07 9068.44 |
5  5.46e+07 9068.44 | 9068.44   86.5    999     0 |    0.49   3.98   0.04   0.00
5  5.83e+07 9068.44 | 9022.83    0.0    999     0 |    0.51   4.04   0.02   0.00
5  6.20e+07 9268.45 |
5  6.20e+07 9268.45 | 9268.45  102.4    999     0 |    0.51   4.35   0.02   0.00
5  6.52e+07 9268.45 | 8558.61    0.0    999     0 |    0.53   4.70  -0.02   0.00
5  6.89e+07 9268.45 | 9048.96    0.0    999     0 |    0.54   4.87  -0.00   0.00
5  7.25e+07 9782.53 |
5  7.25e+07 9782.53 | 9782.53   59.5    999     0 |    0.54   4.61   0.02   0.00
5  7.57e+07 9782.53 | 9434.72  653.1    999     0 |    0.55   4.80   0.04   0.00
5  7.89e+07 9929.08 |
5  7.89e+07 9929.08 | 9929.08   78.6    999     0 |    0.56   4.59   0.07   0.00
5  8.26e+07 9929.08 | 8626.38 1524.7    906    93 |    0.57   4.79   0.03   0.00
5  8.63e+0710097.79 |
5  8.63e+0710097.79 |10097.79   67.8    999     0 |    0.58   4.80   0.02   0.00
5  9.00e+0710097.79 | 6753.56    0.0    689     0 |    0.58   4.86   0.01   0.00
5  9.37e+0710097.79 | 9906.23    0.0    999     0 |    0.59   4.71   0.03   0.00
5  9.72e+0710097.79 | 9780.64    0.0    999     0 |    0.60   5.20  -0.02   0.00
5  1.01e+0810626.80 |
5  1.01e+0810626.80 |10626.80  184.4    999     0 |    0.61   5.13   0.04   0.00
5  1.04e+0810626.80 | 9408.59    0.0    999     0 |    0.62   5.69  -0.03   0.00
5  1.08e+0810626.80 |10539.27    0.0    999     0 |    0.62   5.03   0.04   0.00
5  1.12e+0810864.20 |
5  1.12e+0810864.20 |10864.20  114.5    999     0 |    0.62   5.86  -0.01   0.00
5  1.15e+0810864.20 |10797.01    0.0    999     0 |    0.63   5.27   0.06   0.00
5  1.19e+0810864.20 |10353.68    0.0    999     0 |    0.64   5.27   0.00   0.00
5  1.22e+0810864.20 |10653.36  462.6    999     0 |    0.63   5.02   0.05   0.00
5  1.26e+0811135.88 |
5  1.26e+0811135.88 |11135.88   30.8    999     0 |    0.63   5.29   0.02   0.00
5  1.30e+0811135.88 |10895.74    0.0    999     0 |    0.64   5.29   0.04   0.00
5  1.33e+0811135.88 |11047.80    0.0    999     0 |    0.65   5.35   0.03   0.00
5  1.37e+0811135.88 |10640.79    0.0    999     0 |    0.65   5.18   0.03   0.00
5  1.41e+0811135.88 |10195.72 1193.0    999     0 |    0.65   5.11   0.01   0.00
5  1.44e+0811135.88 | 9187.88    0.0    999     0 |    0.65   5.32   0.03   0.00
5  1.47e+0811187.77 |
5  1.47e+0811187.77 |11187.77  270.7    999     0 |    0.65   6.05   0.03   0.00
5  1.51e+0811250.55 |
5  1.51e+0811250.55 |11250.55   47.4    999     0 |    0.66   6.06  -0.06   0.00
5  1.55e+0811258.22 |
5  1.55e+0811258.22 |11258.22  265.7    999     0 |    0.67   5.77  -0.07   0.00
5  1.58e+0811258.22 |10042.97    0.0    999     0 |    0.67   4.94   0.03   0.00
5  1.62e+0811258.22 |11129.98    0.0    999     0 |    0.66   5.54   0.05   0.00
5  1.65e+0811258.22 |10736.87  554.5    999     0 |    0.67   5.60  -0.01   0.00
5  1.69e+0811258.22 |10130.68 1243.9    978    22 |    0.67   6.04  -0.02   0.00
5  1.72e+0811313.79 |
5  1.72e+0811313.79 |11313.79  355.1    999     0 |    0.68   4.97   0.07   0.00
5  1.76e+0811313.79 |10586.41 1050.1    999     0 |    0.68   5.55  -0.03   0.00
5  1.80e+0811339.15 |
5  1.80e+0811339.15 |11339.15  144.3    999     0 |    0.68   5.48   0.00   0.00
5  1.83e+0811339.15 |11039.22    0.0    999     0 |    0.68   5.45  -0.02   0.00
5  1.87e+0811537.60 |
5  1.87e+0811537.60 |11537.60    2.8    999     0 |    0.68   5.35   0.01   0.00
5  1.90e+0811837.19 |
5  1.94e+0811837.19 |10861.01    0.0    999     0 |    0.66   5.97   0.00   0.00
5  1.98e+0811837.19 |11585.31    0.0    999     0 |    0.67   5.23   0.05   0.00
5  2.01e+0811837.19 |11501.91  435.5    999     0 |    0.68   6.66  -0.03   0.00
5  2.05e+0811837.19 |11754.03  194.8    999     0 |    0.69   5.84   0.03   0.00
5  2.08e+0811837.19 |11647.83    0.0    999     0 |    0.68   5.33   0.02   0.00
5  2.12e+0811837.19 |11824.40    0.0    999     0 |    0.69   6.11  -0.01   0.00
5  2.16e+0811837.19 | 9849.55    0.0    999     0 |    0.69   5.86  -0.03   0.00
5  2.19e+0811837.19 |11707.01    0.0    999     0 |    0.69   5.90   0.02   0.00
5  2.23e+0811837.19 | 9964.05    0.0    999     0 |    0.69   5.48   0.03   0.00
5  2.26e+0811837.19 |11777.00    0.0    999     0 |    0.68   5.46   0.01   0.00
5  2.30e+0811837.19 |11466.23  525.9    999     0 |    0.67   5.37  -0.02   0.00
5  2.34e+0811837.19 |11501.46    0.0    999     0 |    0.67   5.61   0.00   0.00
5  2.37e+0811837.19 |11641.14    0.0    999     0 |    0.68   5.57   0.02   0.00
5  2.41e+0811837.19 |11531.93    0.0    999     0 |    0.68   5.46   0.01   0.00
5  2.44e+0811837.19 |11611.25    0.0    999     0 |    0.68   4.78   0.07   0.00
5  2.48e+0811837.19 | 9939.56    0.0    999     0 |    0.69   5.54   0.00   0.00
5  2.52e+0811837.19 |11487.50    0.0    999     0 |    0.68   5.24   0.05   0.00
5  2.55e+0811837.19 |11788.89    0.0    999     0 |    0.68   5.25   0.04   0.00
5  2.59e+0811837.19 |11246.41    0.0    999     0 |    0.68   5.00   0.05   0.00
5  2.62e+0811837.19 |11147.01    0.0    999     0 |    0.68   5.63   0.02   0.00
5  2.66e+0811837.19 |10095.05    0.0    999     0 |    0.69   5.57   0.06   0.00
5  2.69e+0811837.19 |10291.63    0.0    999     0 |    0.69   5.42   0.03   0.00
5  2.73e+0811837.19 |11723.41    0.0    999     0 |    0.69   5.48  -0.02   0.00
5  2.77e+0811837.19 |11789.32    0.0    999     0 |    0.69   5.41   0.07   0.00
5  2.80e+0811837.19 |11722.76    0.0    999     0 |    0.69   5.57   0.03   0.00
5  2.84e+0811837.19 |11158.46    0.0    999     0 |    0.68   5.34   0.04   0.00
5  2.87e+0811837.19 |10943.61    0.0    999     0 |    0.69   5.39   0.03   0.00
5  2.91e+0811837.19 |11618.53    0.0    999     0 |    0.68   5.03   0.05   0.00
5  2.95e+0811837.19 |11408.62    0.0    999     0 |    0.69   5.34   0.02   0.00
5  2.99e+0812038.03 |
5  2.99e+0812038.03 |12038.03   91.2    999     0 |    0.70   5.58   0.03   0.00
5  3.02e+0812038.03 |11243.29    0.0    999     0 |    0.69   5.45   0.04   0.00
5  3.06e+0812038.03 |11989.24  111.8    999     0 |    0.69   5.86  -0.01   0.00
5  3.09e+0812038.03 |10490.47 1731.9    940    58 |    0.70   5.29   0.03   0.00
5  3.13e+0812038.03 |11856.33  356.5    999     0 |    0.69   5.94   0.01   0.00
5  3.17e+0812038.03 | 4712.17    0.0    457     0 |    0.69   5.57  -0.01   0.00
5  3.20e+0812038.03 |11649.08    0.0    999     0 |    0.69   5.47   0.05   0.00
5  3.24e+0812038.03 |11829.52    0.0    999     0 |    0.69   5.23   0.02   0.00
5  3.27e+0812038.03 | 4106.64    0.0    457     0 |    0.70   5.49   0.01   0.00
5  3.31e+0812038.03 |11764.93    0.0    999     0 |    0.70   5.41   0.04   0.00
5  3.35e+0812038.03 |11908.82    0.0    999     0 |    0.70   5.02   0.02   0.00
5  3.38e+0812038.03 |11762.90    0.0    999     0 |    0.69   5.27   0.03   0.00
5  3.42e+0812038.03 |11614.01    0.0    999     0 |    0.70   5.57   0.03   0.00
5  3.45e+0812038.03 |11897.09    0.0    999     0 |    0.70   5.72   0.05   0.00
5  3.49e+0812038.03 | 6554.87    0.0    617     0 |    0.69   5.51   0.02   0.00
5  3.52e+0812038.03 |11917.55    0.0    999     0 |    0.70   5.86   0.01   0.00
5  3.56e+0812038.03 |11911.26    0.0    999     0 |    0.70   5.58  -0.03   0.00
5  3.60e+0812038.03 | 4371.31    0.0    654     0 |    0.70   5.35   0.01   0.00
5  3.63e+0812038.03 |11799.74    0.0    999     0 |    0.69   5.67   0.01   0.00
5  3.67e+0812282.57 |
5  3.67e+0812282.57 |12282.57   55.5    999     0 |    0.70   5.82  -0.01   0.00
5  3.70e+0812282.57 |11976.41    0.0    999     0 |    0.70   5.90  -0.02   0.00
5  3.74e+0812282.57 |11931.33    0.0    999     0 |    0.71   5.48   0.04   0.00
5  3.78e+0812282.57 |12255.16   32.2    999     0 |    0.71   6.00   0.02   0.00
5  3.81e+0812282.57 |11734.02    0.0    999     0 |    0.72   5.14   0.02   0.00
5  3.85e+0812282.57 |12210.93    0.0    999     0 |    0.72   5.33   0.05   0.00
5  3.89e+0812282.57 |11950.65    0.0    999     0 |    0.72   5.31   0.05   0.00
5  3.92e+0812282.57 |12060.55  436.2    999     0 |    0.72   5.86   0.03   0.00
5  3.96e+0812282.57 |11988.52    0.0    999     0 |    0.72   5.15   0.02   0.00
5  3.99e+0812282.57 |11983.27    0.0    999     0 |    0.72   5.91   0.06   0.00
5  4.03e+0812282.57 |10438.71    0.0    999     0 |    0.71   5.35   0.04   0.00
5  4.06e+0812282.57 |12034.14    0.0    999     0 |    0.72   5.28   0.04   0.00
5  4.10e+0812282.57 |12131.99    0.0    999     0 |    0.72   5.07   0.02   0.00
5  4.14e+0812282.57 |11892.33    0.0    999     0 |    0.72   5.29  -0.00   0.00
5  4.17e+0812330.35 |
5  4.17e+0812330.35 |12330.35   26.9    999     0 |    0.71   5.84   0.02   0.00
5  4.21e+0812330.35 |10513.44    0.0    999     0 |    0.72   5.17   0.03   0.00
5  4.25e+0812330.35 |10251.97    0.0    999     0 |    0.71   5.39   0.05   0.00
5  4.28e+0812330.35 | 6518.90    0.0    684     0 |    0.71   5.62  -0.01   0.00
5  4.32e+0812330.35 |12324.02    0.0    999     0 |    0.72   5.37   0.05   0.00
| UsedTime:   68499 | SavedDir: ./Ant_PPO_5
        """
    elif env_name == 'Ant.12562  args.if_use_old_traj = True':
        env_func = IsaacVecEnv
        env_args = {
            'env_num': 1024,
            'env_name': 'Ant',
            'max_step': 1000,
            'state_dim': 60,
            'action_dim': 8,
            'if_discrete': False,
            'target_return': 15000.,

            'sim_device_id': gpu_id,
            'rl_device_id': gpu_id,
        }
        args = Arguments(agent_class, env_func=env_func, env_args=env_args)
        args.eval_env_func = IsaacOneEnv
        args.eval_env_args = {
            'env_num': 1,
            'env_name': 'Ant',
            'max_step': 1000,
            'state_dim': 60,
            'action_dim': 8,
            'if_discrete': False,
            'target_return': 15000.,

            'device_id': gpu_id,
        }

        args.reward_scale = 2 ** -4  # todo plan to be 2 ** -6 and learning_rate = 2 ** -14
        args.if_cri_target = False

        args.net_dim = 2 ** 8
        args.batch_size = args.net_dim * 4
        args.repeat_times = 2 ** 4
        args.gamma = 0.985
        args.if_use_gae = True
        args.learning_rate = 2 ** -15

        args.target_step = args.max_step
        args.batch_size = args.net_dim * 4
        args.worker_num = 1
        args.if_use_old_traj = True  # todo
        args.lambda_gae_adv = 0.85

        args.lambda_entropy = 2 ** -14  # 2 ** -10

        args.eval_gap = 2 ** 9
        args.eval_times = 2 ** 1
        args.max_step = int(6e7)
        """
        ################################################################################
ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
[Error] [carb.windowing-glfw.plugin] GLFW initialization failed.
[Error] [carb.windowing-glfw.plugin] GLFW window creation failed!
[Error] [carb.gym.plugin] Failed to create Window in CreateGymViewerInternal
4  1.74e+06  603.95 |
4  1.74e+06  603.95 |  603.95    4.3    999     0 |    0.03   0.63  -0.03   0.00
4  5.73e+06  603.95 |  515.16    0.0    999     0 |    0.06   0.61  -0.07   0.00
4  9.81e+06  853.03 |
4  9.81e+06  853.03 |  853.03   88.4    999     0 |    0.09   0.71  -0.10   0.00
4  1.39e+07  853.03 |  703.40    0.0    261     0 |    0.12   0.96  -0.05   0.00
4  1.80e+07 3582.81 |
4  1.80e+07 3582.81 | 3582.81   46.1    999     0 |    0.15   1.06  -0.07   0.00

4  2.21e+07 3582.81 | 3370.03    0.0    928     0 |    0.18   1.32  -0.09   0.00
4  2.62e+07 3655.31 |
4  2.62e+07 3655.31 | 3655.31   60.3    906    94 |    0.21   1.49  -0.08   0.00
4  3.03e+07 4827.33 |
4  3.03e+07 4827.33 | 4827.33  182.7    994     5 |    0.23   1.60  -0.06   0.00
4  3.44e+07 4827.33 | 3313.27 1995.4    698   300 |    0.26   2.00  -0.14   0.00
4  3.85e+07 5148.43 |
4  3.85e+07 5148.43 | 5148.43   56.6    981    18 |    0.28   1.76  -0.08   0.00
4  4.25e+07 5888.33 |
4  4.25e+07 5888.33 | 5888.33   12.4    999     0 |    0.29   1.87  -0.08   0.00
4  4.66e+07 6187.02 |
4  4.66e+07 6187.02 | 6187.02   24.9    999     0 |    0.31   1.98  -0.07   0.00
4  5.07e+07 6187.02 | 6007.17    0.0    999     0 |    0.32   2.11  -0.05   0.00
4  5.48e+07 6266.68 |
4  5.48e+07 6266.68 | 6266.68  268.0    999     0 |    0.34   2.30  -0.11   0.00
4  5.89e+07 6266.68 | 5969.50    0.0    999     0 |    0.35   2.17  -0.05   0.00
4  6.30e+07 6707.67 |
4  6.30e+07 6707.67 | 6707.67  427.9    999     0 |    0.37   2.16  -0.07   0.00
4  6.71e+07 7113.01 |
4  6.71e+07 7113.01 | 7113.01  129.6    999     0 |    0.38   2.40  -0.06   0.00
4  7.12e+07 7113.01 | 6141.00    0.0    890     0 |    0.39   2.65  -0.09   0.00
4  7.53e+07 7233.51 |
4  7.53e+07 7233.51 | 7233.51  219.9    999     0 |    0.40   2.27  -0.03   0.00
4  7.94e+07 7353.76 |
4  7.94e+07 7353.76 | 7353.76  603.0    999     0 |    0.41   2.63  -0.06   0.00
4  8.35e+07 7577.64 |
4  8.35e+07 7577.64 | 7577.64    7.7    999     0 |    0.43   2.64  -0.06   0.00
4  8.76e+07 7800.49 |
4  8.76e+07 7800.49 | 7800.49   68.6    999     0 |    0.43   2.69  -0.08   0.00
4  9.17e+07 7800.49 | 7665.55  709.6    999     0 |    0.44   2.73  -0.04   0.00
4  9.58e+07 8489.92 |
4  9.58e+07 8489.92 | 8489.92  126.2    999     0 |    0.45   2.77  -0.07   0.00
4  9.99e+07 8489.92 | 6440.10    0.0    874     0 |    0.46   2.78  -0.12   0.00
4  1.04e+08 8489.92 | 8101.23    0.0    999     0 |    0.47   2.85  -0.05   0.00
4  1.08e+08 8723.74 |
4  1.08e+08 8723.74 | 8723.74   58.5    999     0 |    0.48   3.14  -0.11   0.00
4  1.12e+08 8723.74 | 8399.21    0.0    999     0 |    0.49   2.65  -0.03   0.00
4  1.16e+08 8987.88 |
4  1.16e+08 8987.88 | 8987.88  111.1    999     0 |    0.49   3.01  -0.09   0.00
4  1.20e+08 8987.88 | 8972.12    0.0    999     0 |    0.49   2.70  -0.03   0.00
4  1.24e+08 8987.88 | 8834.08    0.0    999     0 |    0.50   3.01  -0.06   0.00
4  1.29e+08 8987.88 | 7846.74    0.0    963     0 |    0.51   2.81  -0.05   0.00
4  1.33e+08 9224.67 |
4  1.33e+08 9224.67 | 9224.67  131.4    999     0 |    0.51   2.78  -0.07   0.00
4  1.37e+08 9224.67 | 9057.21  473.8    999     0 |    0.52   3.18  -0.10   0.00
4  1.41e+08 9224.67 | 8602.97    0.0    999     0 |    0.52   2.82  -0.08   0.00
4  1.45e+08 9350.09 |
4  1.45e+08 9350.09 | 9350.09  111.9    999     0 |    0.52   2.99  -0.07   0.00
4  1.49e+08 9601.43 |
4  1.49e+08 9601.43 | 9601.43  238.9    999     0 |    0.53   2.79  -0.03   0.00
4  1.53e+08 9712.42 |
4  1.53e+08 9712.42 | 9712.42  144.7    999     0 |    0.54   3.01  -0.03   0.00
4  1.57e+08 9921.83 |
4  1.57e+08 9921.83 | 9921.83   40.4    999     0 |    0.54   3.07  -0.05   0.00
4  1.61e+08 9921.83 | 9676.70    0.0    999     0 |    0.54   2.73  -0.04   0.00
4  1.65e+08 9921.83 | 9593.89    0.0    999     0 |    0.55   2.78  -0.03   0.00
4  1.70e+08 9921.83 | 9582.72    0.0    999     0 |    0.55   3.05  -0.04   0.00
4  1.74e+0810109.78 |
4  1.74e+0810109.78 |10109.78   95.3    999     0 |    0.56   3.04  -0.05   0.00
4  1.78e+0810109.78 |10041.69    0.0    999     0 |    0.56   3.56  -0.05   0.00
4  1.82e+0810109.78 |10024.49    0.0    999     0 |    0.57   2.82  -0.02   0.00
4  1.86e+0810342.51 |
4  1.86e+0810342.51 |10342.51   62.7    999     0 |    0.57   2.95  -0.01   0.00
4  1.90e+0810342.51 |10026.13    0.0    999     0 |    0.57   2.81  -0.04   0.00
4  1.94e+0810342.51 |10245.27  106.4    999     0 |    0.57   2.77  -0.04   0.00
4  1.98e+0810426.35 |
4  1.98e+0810426.35 |10426.35  165.8    999     0 |    0.57   3.38  -0.03   0.00
4  2.02e+0810426.35 | 8375.25 2262.0    851   148 |    0.58   3.06  -0.06   0.00
4  2.06e+0810426.35 | 6925.42    0.0    744     0 |    0.58   3.25  -0.03   0.00
4  2.10e+0810426.35 | 9817.29  723.3    999     0 |    0.58   3.02  -0.02   0.00
4  2.15e+0810527.63 |
4  2.15e+0810527.63 |10527.63   37.0    999     0 |    0.59   3.58  -0.05   0.00
4  2.19e+0810527.63 |10521.68  103.2    999     0 |    0.59   3.10  -0.04   0.00
4  2.23e+0810764.68 |
4  2.23e+0810764.68 |10764.68   92.2    999     0 |    0.60   3.10  -0.03   0.00
4  2.27e+0810764.68 | 9392.83    0.0    999     0 |    0.60   3.53  -0.04   0.00
4  2.31e+0810764.68 |10759.78    0.0    999     0 |    0.60   3.39  -0.01   0.00
4  2.35e+0810877.18 |
4  2.35e+0810877.18 |10877.18  157.4    999     0 |    0.60   3.53  -0.06   0.00
4  2.39e+0810877.18 |10773.02  144.1    999     0 |    0.60   3.25  -0.03   0.00
4  2.43e+0810913.59 |
4  2.43e+0810913.59 |10913.59   63.7    999     0 |    0.60   3.70  -0.08   0.00
4  2.47e+0810993.61 |
4  2.47e+0810993.61 |10993.61  343.5    999     0 |    0.60   3.21  -0.03   0.00
4  2.51e+0810993.61 |10946.93  421.5    999     0 |    0.60   3.23  -0.01   0.00
4  2.55e+0811159.28 |
4  2.55e+0811159.28 |11159.28   40.9    999     0 |    0.61   3.37  -0.05   0.00
4  2.60e+0811159.28 |10918.85    0.0    999     0 |    0.61   3.42  -0.04   0.00
4  2.64e+0811221.63 |
4  2.64e+0811221.63 |11221.63  166.3    999     0 |    0.62   3.34  -0.04   0.00
4  2.68e+0811221.63 |11193.66  111.8    999     0 |    0.62   3.47  -0.07   0.00
4  2.72e+0811453.91 |
4  2.72e+0811453.91 |11453.91   47.9    999     0 |    0.62   3.76  -0.05   0.00
4  2.76e+0811453.91 |11235.41    0.0    999     0 |    0.63   3.82  -0.02   0.00
4  2.80e+0811519.55 |
4  2.80e+0811519.55 |11519.55   65.5    999     0 |    0.63   3.36  -0.04   0.00
4  2.84e+0811519.55 |11285.73    0.0    999     0 |    0.63   3.43  -0.04   0.00
4  2.88e+0811519.55 |10369.77 1242.2    999     0 |    0.63   3.49  -0.07   0.00
4  2.92e+0811519.55 |11082.33    0.0    999     0 |    0.63   4.08  -0.07   0.00
4  2.95e+0811659.52 |
4  2.95e+0811659.52 |11659.52  141.7    999     0 |    0.64   3.72  -0.05   0.00
4  3.00e+0811659.52 |10813.01  943.3    999     0 |    0.64   3.56  -0.04   0.00
4  3.04e+0811659.52 |10833.79 1099.8    999     0 |    0.65   4.03  -0.06   0.00
4  3.07e+0811659.52 |11544.14    0.0    999     0 |    0.64   3.60  -0.04   0.00
4  3.10e+0811659.52 |11335.43    0.0    999     0 |    0.64   3.01   0.03   0.00
4  3.13e+0811659.52 |11655.46    0.0    999     0 |    0.65   3.81  -0.03   0.00
4  3.16e+0811659.52 |11560.00    0.0    999     0 |    0.65   3.79  -0.07   0.00
4  3.19e+0811749.88 |
4  3.19e+0811749.88 |11749.88  113.7    999     0 |    0.66   3.71  -0.04   0.00
4  3.22e+0811749.88 |11710.82    0.0    999     0 |    0.66   3.77  -0.05   0.00
4  3.25e+0811749.88 |10795.55    0.0    999     0 |    0.66   3.32   0.02   0.00
4  3.28e+0811749.88 | 6321.17    0.0    712     0 |    0.66   3.46  -0.02   0.00
4  3.31e+0811837.87 |
4  3.31e+0811837.87 |11837.87  242.9    999     0 |    0.65   3.73  -0.04   0.00
4  3.34e+0811837.87 |11269.19  734.5    999     0 |    0.65   3.34  -0.04   0.00
4  3.37e+0811837.87 |11794.74    0.0    999     0 |    0.66   3.50  -0.05   0.00
4  3.41e+0811837.87 |11268.03    0.0    999     0 |    0.66   3.85  -0.02   0.00
4  3.44e+0811837.87 |10725.88 1342.3    999     0 |    0.66   3.93  -0.05   0.00
4  3.47e+0811837.87 |10873.14    0.0    999     0 |    0.67   4.13  -0.05   0.00
4  3.50e+0811837.87 | 9218.36    0.0    999     0 |    0.66   3.86  -0.01   0.00
4  3.53e+0811837.87 |11056.13    0.0    999     0 |    0.67   3.75  -0.05   0.00
4  3.56e+0811837.87 |11785.62  136.2    999     0 |    0.67   3.73  -0.07   0.00
4  3.59e+0811837.87 |10722.05    0.0    999     0 |    0.67   3.95   0.02   0.00
4  3.63e+0812279.73 |
4  3.63e+0812279.73 |12279.73  127.6    999     0 |    0.67   3.91  -0.07   0.00
4  3.67e+0812279.73 |11679.46    0.0    999     0 |    0.68   4.14  -0.11   0.00
4  3.71e+0812279.73 |10798.62    0.0    999     0 |    0.68   3.63  -0.03   0.00
4  3.75e+0812279.73 | 9335.38    0.0    999     0 |    0.68   3.66  -0.02   0.00
4  3.79e+0812562.77 |
4  3.79e+0812562.77 |12562.77   11.6    999     0 |    0.68   3.44  -0.01   0.00
4  3.84e+0812562.77 |12462.22  216.2    999     0 |    0.68   3.66  -0.03   0.00
4  3.88e+0812562.77 |12181.32    0.0    999     0 |    0.68   3.95  -0.06   0.00
4  3.92e+0812562.77 |11326.53    0.0    999     0 |    0.68   4.41  -0.05   0.00
4  3.96e+0812562.77 |12487.80    0.0    999     0 |    0.69   3.77  -0.04   0.00
4  4.00e+0812562.77 |12541.86   42.9    999     0 |    0.70   4.06  -0.04   0.00
| UsedTime:   62635 | SavedDir: ./Ant_PPO_4
| Learner: Save in ./Ant_PPO_4
        """
    elif env_name == 'Humanoid':
        env_func = IsaacVecEnv
        env_args = {
            'env_num': 1024,
            'env_name': 'Humanoid',
            'max_step': 1000,
            'state_dim': 108,
            'action_dim': 21,
            'if_discrete': False,
            'target_return': 15000.,

            'sim_device_id': gpu_id,
            'rl_device_id': gpu_id,
        }
        args = Arguments(agent_class, env_func=env_func, env_args=env_args)
        args.eval_env_func = IsaacOneEnv
        args.eval_env_args = {
            'env_num': 1,
            'env_name': 'Humanoid',
            'max_step': 1000,
            'state_dim': 108,
            'action_dim': 21,
            'if_discrete': False,
            'target_return': 15000.,

            'device_id': gpu_id,
        }

        args.reward_scale = 2 ** -4
        args.if_cri_target = False

        args.repeat_times = 2 ** 4
        args.gamma = 0.985
        args.if_use_gae = True
        args.learning_rate = 2 ** -15

        args.target_step = args.max_step
        args.batch_size = args.net_dim * 4
        args.worker_num = 1
        args.if_use_old_traj = False
        if gpu_id == 2:
            args.net_dim = 2 ** 9
            args.batch_size = args.net_dim * 8  # todo
            args.repeat_times = 2 ** 5
            args.lambda_gae_adv = 0.85
            args.learning_rate = 2 ** -13
        if gpu_id == 3:
            args.net_dim = 2 ** 8
            args.batch_size = args.net_dim * 4
            args.repeat_times = 2 ** 4
            args.lambda_gae_adv = 0.85
            args.learning_rate = 2 ** -15

        args.lambda_entropy = 2 ** -6

        args.eval_gap = 2 ** 9
        args.eval_times = 2 ** 1
        args.max_step = int(6e7)
    elif env_name == 'Humanoid.8686':
        env_func = IsaacVecEnv
        env_args = {
            'env_num': 1024,
            'env_name': 'Humanoid',
            'max_step': 1000,
            'state_dim': 108,
            'action_dim': 21,
            'if_discrete': False,
            'target_return': 15000.,

            'sim_device_id': gpu_id,
            'rl_device_id': gpu_id,
        }
        args = Arguments(agent_class, env_func=env_func, env_args=env_args)
        args.eval_env_func = IsaacOneEnv
        args.eval_env_args = {
            'env_num': 1,
            'env_name': 'Humanoid',
            'max_step': 1000,
            'state_dim': 108,
            'action_dim': 21,
            'if_discrete': False,
            'target_return': 15000.,

            'device_id': gpu_id,
        }

        args.reward_scale = 2 ** -4
        args.if_cri_target = False

        args.repeat_times = 2 ** 4
        args.gamma = 0.985
        args.if_use_gae = True
        args.learning_rate = 2 ** -15

        args.target_step = args.max_step
        args.batch_size = args.net_dim * 4
        args.worker_num = 1
        args.if_use_old_traj = False
        args.net_dim = 2 ** 9
        args.batch_size = args.net_dim * 8  # todo
        args.repeat_times = 2 ** 5
        args.lambda_gae_adv = 0.85
        args.learning_rate = 2 ** -13

        args.lambda_entropy = 2 ** -6

        args.eval_gap = 2 ** 9
        args.eval_times = 2 ** 1
        args.max_step = int(6e7)

        """
################################################################################
ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
[Error] [carb.windowing-glfw.plugin] GLFW initialization failed.
[Error] [carb.windowing-glfw.plugin] GLFW window creation failed!
[Error] [carb.gym.plugin] Failed to create Window in CreateGymViewerInternal
2  2.02e+06   71.78 |
2  2.02e+06   71.78 |   71.78   12.4     36     2 |    0.14   0.18   0.08   0.00

2  6.02e+06  109.81 |
2  6.02e+06  109.81 |  109.81   26.1     43     1 |    0.16   0.14   0.05   0.00
2  1.10e+07  195.23 |
2  1.10e+07  195.23 |  195.23   25.3     64    12 |    0.17   0.13   0.07   0.00
2  1.60e+07  195.23 |  185.08    0.0     56     0 |    0.18   0.11   0.09   0.00
2  2.09e+07  195.23 |  186.54    0.0     76     0 |    0.19   0.14   0.07   0.00
2  2.58e+07  229.67 |
2  2.58e+07  229.67 |  229.67    3.8     86     4 |    0.20   0.24   0.08   0.00
2  3.07e+07  343.69 |
2  3.07e+07  343.69 |  343.69    0.6    132     2 |    0.21   0.40   0.10   0.00
2  3.55e+07 1679.27 |
2  3.55e+07 1679.27 | 1679.27  201.3    510    72 |    0.22   0.62   0.08   0.00
2  4.02e+07 1679.27 | 1154.88    0.0    301     0 |    0.23   0.93   0.08   0.00
2  4.45e+07 1679.27 | 1623.16    0.0    369     0 |    0.25   1.13   0.08   0.00
2  4.88e+07 3377.29 |
2  4.88e+07 3377.29 | 3377.29 1513.6    694   305 |    0.28   1.35   0.08   0.00
2  5.31e+07 5344.39 |
2  5.31e+07 5344.39 | 5344.39   25.8    999     0 |    0.31   1.76   0.05   0.00
2  5.71e+07 5679.54 |
2  5.71e+07 5679.54 | 5679.54    1.2    999     0 |    0.33   1.91   0.05   0.00
2  6.10e+07 5679.54 | 5602.18    0.0    999     0 |    0.35   1.97   0.07   0.00
2  6.48e+07 6116.60 |
2  6.48e+07 6116.60 | 6116.60   36.2    999     0 |    0.37   2.34   0.08   0.00
2  6.85e+07 6295.71 |
2  6.85e+07 6295.71 | 6295.71    9.1    999     0 |    0.38   2.42   0.04   0.00
2  7.26e+07 6422.94 |
2  7.26e+07 6422.94 | 6422.94   26.4    999     0 |    0.39   2.56   0.02   0.00
2  7.66e+07 6508.94 |
2  7.66e+07 6508.94 | 6508.94   50.4    999     0 |    0.40   2.92   0.04   0.00
2  8.07e+07 6632.57 |
2  8.07e+07 6632.57 | 6632.57   17.9    999     0 |    0.41   2.67   0.06   0.00
2  8.47e+07 6736.83 |
2  8.47e+07 6736.83 | 6736.83   76.0    999     0 |    0.42   2.87   0.02   0.00
2  8.88e+07 6913.29 |
2  8.88e+07 6913.29 | 6913.29    3.4    999     0 |    0.42   2.93   0.05   0.00
2  9.28e+07 6941.66 |
2  9.28e+07 6941.66 | 6941.66    1.2    999     0 |    0.42   2.91   0.08   0.00
2  9.68e+07 6941.66 | 5882.48 1115.5    850   148 |    0.43   2.85   0.07   0.00
2  1.01e+08 6941.66 | 6615.23    0.0    946     0 |    0.43   2.96   0.04   0.00
2  1.05e+08 7056.03 |
2  1.05e+08 7056.03 | 7056.03   53.6    999     0 |    0.44   2.97   0.06   0.00
2  1.09e+08 7056.03 | 6943.94    0.0    999     0 |    0.44   3.03   0.05   0.00
2  1.13e+08 7186.16 |
2  1.13e+08 7186.16 | 7186.16   18.0    999     0 |    0.45   2.98   0.08   0.00
2  1.17e+08 7186.55 |
2  1.17e+08 7186.55 | 7186.55    1.6    999     0 |    0.45   3.25   0.04   0.00
2  1.21e+08 7186.55 | 7158.49    0.0    999     0 |    0.45   3.07   0.05   0.00
2  1.25e+08 7186.55 | 7171.98    0.0    999     0 |    0.45   2.93   0.06   0.00
2  1.29e+08 7265.19 |
2  1.29e+08 7265.19 | 7265.19    8.5    999     0 |    0.45   2.93   0.06   0.00
2  1.33e+08 7350.53 |
2  1.33e+08 7350.53 | 7350.53    0.5    999     0 |    0.46   2.97   0.08   0.00
2  1.36e+08 7350.53 | 7318.17    0.0    999     0 |    0.46   3.26   0.07   0.00
2  1.40e+08 7506.29 |
2  1.40e+08 7506.29 | 7506.29    3.5    999     0 |    0.46   3.10   0.07   0.00
2  1.44e+08 7506.29 | 7497.85    0.0    999     0 |    0.46   3.15   0.07   0.00
2  1.48e+08 7573.97 |
2  1.48e+08 7573.97 | 7573.97    6.9    999     0 |    0.46   3.62   0.02   0.00
2  1.52e+08 7573.97 | 7430.94    0.0    999     0 |    0.47   3.34   0.05   0.00
2  1.56e+08 7573.97 | 7472.38    0.0    999     0 |    0.47   3.51   0.06   0.00
2  1.59e+08 7619.16 |
2  1.59e+08 7619.16 | 7619.16    1.2    999     0 |    0.47   3.50   0.05   0.00
2  1.63e+08 7619.16 |  237.11    0.0    163     0 |    0.47   3.18   0.06   0.00
2  1.67e+08 7674.13 |
2  1.67e+08 7674.13 | 7674.13   41.4    999     0 |    0.48   3.42   0.04   0.00
2  1.71e+08 7683.78 |
2  1.71e+08 7683.78 | 7683.78   23.2    999     0 |    0.48   3.48   0.04   0.00
2  1.75e+08 7683.78 | 7674.56   96.3    999     0 |    0.48   3.67   0.04   0.00
2  1.78e+08 7786.97 |
2  1.78e+08 7786.97 | 7786.97    2.6    999     0 |    0.48   3.50   0.07   0.00
2  1.82e+08 7786.97 | 7771.78   18.5    999     0 |    0.48   3.54   0.05   0.00
2  1.86e+08 7786.97 | 4656.75    0.0    629     0 |    0.48   3.57   0.04   0.00
2  1.89e+08 7786.97 | 7743.48   80.1    999     0 |    0.49   3.59   0.04   0.00
2  1.93e+08 7924.90 |
2  1.93e+08 7924.90 | 7924.90   37.2    999     0 |    0.49   3.74   0.03   0.00
2  1.97e+08 7924.90 | 7903.48    0.0    999     0 |    0.49   3.74   0.04   0.00
2  2.00e+08 7925.32 |
2  2.00e+08 7925.32 | 7925.32    3.0    999     0 |    0.49   3.78   0.05   0.00
2  2.04e+08 7958.02 |
2  2.04e+08 7958.02 | 7958.02   70.6    999     0 |    0.49   3.67   0.04   0.00
2  2.08e+08 7958.02 | 7952.52    0.0    999     0 |    0.49   3.76   0.04   0.00
2  2.11e+08 7983.21 |
2  2.11e+08 7983.21 | 7983.21    3.9    999     0 |    0.49   3.81   0.04   0.00
2  2.15e+08 7983.21 | 7656.37    0.0    999     0 |    0.50   3.81   0.04   0.00
2  2.18e+08 8035.29 |
2  2.18e+08 8035.29 | 8035.29   30.9    999     0 |    0.50   3.66   0.05   0.00
2  2.22e+08 8035.29 | 7941.13    0.0    999     0 |    0.50   3.71   0.05   0.00
2  2.26e+08 8035.29 | 7798.48    0.0    999     0 |    0.50   3.92   0.06   0.00
2  2.30e+08 8035.29 | 7858.21    0.0    999     0 |    0.50   3.58   0.05   0.00
2  2.33e+08 8035.29 | 4127.11 3952.5    534   465 |    0.50   3.61   0.07   0.00
2  2.37e+08 8035.29 | 4088.30 3948.2    538   460 |    0.50   3.90   0.04   0.00
2  2.41e+08 8086.63 |
2  2.41e+08 8086.63 | 8086.63   48.4    999     0 |    0.50   3.82   0.05   0.00
2  2.44e+08 8098.47 |
2  2.44e+08 8098.47 | 8098.47   17.0    999     0 |    0.50   3.70   0.04   0.00
2  2.48e+08 8143.12 |
2  2.48e+08 8143.12 | 8143.12    2.3    999     0 |    0.50   3.82   0.07   0.00
2  2.52e+08 8143.12 |  219.54    0.0     67     0 |    0.50   4.01   0.04   0.00
2  2.56e+08 8143.12 | 8088.18    0.0    999     0 |    0.50   3.84   0.06   0.00
2  2.60e+08 8189.77 |
2  2.60e+08 8189.77 | 8189.77   18.9    999     0 |    0.51   3.80   0.06   0.00
2  2.64e+08 8189.77 | 8067.71    0.0    999     0 |    0.50   3.88   0.06   0.00
2  2.68e+08 8189.77 | 8182.07    0.0    999     0 |    0.51   3.79   0.05   0.00
2  2.72e+08 8189.77 | 8150.14    0.0    999     0 |    0.50   3.81   0.03   0.00
2  2.76e+08 8189.77 | 4163.22 4051.4    529   470 |    0.50   4.16   0.02   0.00
2  2.80e+08 8198.42 |
2  2.80e+08 8198.42 | 8198.42   56.4    999     0 |    0.50   3.99   0.05   0.00
2  2.83e+08 8198.42 | 8065.23    0.0    999     0 |    0.50   3.99   0.05   0.00
2  2.87e+08 8198.42 |  110.36    0.0     34     0 |    0.50   3.93   0.05   0.00
2  2.90e+08 8259.31 |
2  2.90e+08 8259.31 | 8259.31    8.7    999     0 |    0.50   3.77   0.08   0.00
2  2.93e+08 8259.31 | 8236.48   31.1    999     0 |    0.51   4.02   0.05   0.00
2  2.96e+08 8259.31 | 7924.47    0.0    999     0 |    0.50   3.89   0.05   0.00
2  3.00e+08 8289.48 |
2  3.00e+08 8289.48 | 8289.48   45.3    999     0 |    0.51   3.85   0.06   0.00
2  3.03e+08 8289.48 | 8197.63    0.0    999     0 |    0.51   3.96   0.04   0.00
2  3.06e+08 8289.48 | 8265.25   39.4    999     0 |    0.51   3.99   0.04   0.00
2  3.09e+08 8289.48 | 4253.46 4115.0    526   474 |    0.51   4.01   0.04   0.00
2  3.12e+08 8352.38 |
2  3.12e+08 8352.38 | 8352.38   13.4    999     0 |    0.51   4.07   0.03   0.00
2  3.16e+08 8352.38 | 8283.24    0.0    999     0 |    0.51   3.86   0.05   0.00
2  3.19e+08 8352.38 | 8314.57    0.0    999     0 |    0.51   3.86   0.05   0.00
2  3.22e+08 8352.38 | 8212.59    0.0    999     0 |    0.51   3.98   0.05   0.00
2  3.25e+08 8352.38 | 8090.58    0.0    999     0 |    0.51   3.96   0.05   0.00
2  3.28e+08 8352.38 | 8291.36    0.0    999     0 |    0.51   3.94   0.04   0.00
2  3.31e+08 8352.38 | 8330.48   86.4    999     0 |    0.51   4.18  -0.00   0.00
2  3.35e+08 8394.85 |
2  3.35e+08 8394.85 | 8394.85   21.4    999     0 |    0.51   3.84   0.05   0.00
2  3.38e+08 8394.85 | 8351.46    0.0    999     0 |    0.52   3.93   0.04   0.00
2  3.41e+08 8401.17 |
2  3.41e+08 8401.17 | 8401.17   98.3    999     0 |    0.51   4.31   0.02   0.00
2  3.44e+08 8401.17 | 8230.35    0.0    999     0 |    0.52   4.26   0.04   0.00
2  3.47e+08 8515.12 |
2  3.47e+08 8515.12 | 8515.12   34.2    999     0 |    0.52   4.27   0.04   0.00
2  3.50e+08 8515.12 | 8343.60    0.0    999     0 |    0.51   4.21   0.03   0.00
2  3.53e+08 8515.12 | 8418.96    0.0    999     0 |    0.51   3.99   0.05   0.00
2  3.56e+08 8515.12 | 8510.77    0.0    999     0 |    0.51   4.20   0.03   0.00
2  3.59e+08 8515.12 | 8442.03    0.0    999     0 |    0.52   3.95   0.07   0.00
2  3.63e+08 8515.12 | 8462.57    0.0    999     0 |    0.52   3.99   0.04   0.00
2  3.66e+08 8515.12 | 8427.00    0.0    999     0 |    0.52   4.05   0.04   0.00
2  3.70e+08 8515.12 | 8362.72    0.0    999     0 |    0.52   3.97   0.04   0.00
2  3.74e+08 8515.12 | 8201.42    0.0    999     0 |    0.52   4.03   0.05   0.00
2  3.77e+08 8515.12 | 8457.91    0.0    999     0 |    0.52   4.08   0.04   0.00
2  3.81e+08 8515.12 | 8499.09    0.0    999     0 |    0.52   3.99   0.05   0.00
2  3.85e+08 8515.12 | 4374.19 4199.9    534   466 |    0.52   4.06   0.05   0.00
2  3.89e+08 8609.47 |
2  3.89e+08 8609.47 | 8609.47   36.2    999     0 |    0.52   4.12   0.05   0.00
2  3.93e+08 8609.47 | 8410.42    0.0    999     0 |    0.52   4.11   0.02   0.00
2  3.97e+08 8609.47 | 8607.97   16.9    999     0 |    0.52   4.18   0.03   0.00
2  4.01e+08 8609.47 | 8582.87    0.0    999     0 |    0.52   4.08   0.04   0.00
2  4.04e+08 8609.47 | 8010.42    0.0    999     0 |    0.52   4.09   0.04   0.00
2  4.08e+08 8609.47 | 8512.01    0.0    999     0 |    0.52   4.35   0.04   0.00
2  4.12e+08 8654.72 |
2  4.12e+08 8654.72 | 8654.72   18.2    999     0 |    0.52   4.07   0.03   0.00
2  4.15e+08 8686.14 |
2  4.15e+08 8686.14 | 8686.14    1.1    999     0 |    0.52   4.19   0.05   0.00
2  4.19e+08 8686.14 | 8565.04    0.0    999     0 |    0.52   4.22   0.06   0.00
2  4.23e+08 8686.14 | 8605.58    0.0    999     0 |    0.52   4.18   0.05   0.00
2  4.26e+08 8686.14 | 8635.16    0.0    999     0 |    0.52   4.29   0.04   0.00
2  4.30e+08 8686.14 | 8480.89    0.0    999     0 |    0.52   4.02   0.04   0.00
2  4.34e+08 8686.14 | 8638.29   52.9    999     0 |    0.53   4.06   0.06   0.00
2  4.37e+08 8686.14 | 8400.74    0.0    999     0 |    0.53   4.25   0.04   0.00
2  4.41e+08 8686.14 | 8584.45    0.0    999     0 |    0.53   4.07   0.05   0.00
2  4.45e+08 8686.14 | 8676.59    0.0    999     0 |    0.53   3.98   0.06   0.00
2  4.48e+08 8686.14 | 8642.88    0.0    999     0 |    0.53   4.06   0.07   0.00
2  4.52e+08 8686.14 | 8503.15    0.0    999     0 |    0.53   4.23   0.04   0.00
2  4.55e+08 8686.43 |
2  4.55e+08 8686.43 | 8686.43   12.0    999     0 |    0.53   4.35   0.06   0.00
2  4.59e+08 8686.43 | 8560.22    0.0    999     0 |    0.53   4.32   0.05   0.00
2  4.63e+08 8686.43 | 8610.58    0.0    999     0 |    0.53   4.34   0.02   0.00
2  4.66e+08 8686.43 | 8261.38    0.0    999     0 |    0.52   4.23   0.04   0.00
2  4.70e+08 8686.43 | 4696.17 4022.1    569   430 |    0.53   4.31   0.03   0.00
2  4.74e+08 8686.43 | 8582.68    0.0    999     0 |    0.53   4.46   0.03   0.00
2  4.77e+08 8686.43 | 8607.55    0.0    999     0 |    0.53   4.31   0.06   0.00
2  4.81e+08 8686.43 | 8650.08    0.0    999     0 |    0.53   4.19   0.05   0.00
2  4.85e+08 8686.43 | 8538.61    0.0    999     0 |    0.53   4.17   0.05   0.00
2  4.89e+08 8686.43 | 8629.97    0.0    999     0 |    0.53   4.09   0.05   0.00
2  4.92e+08 8715.26 |
2  4.92e+08 8715.26 | 8715.26   12.1    999     0 |    0.53   4.30   0.06   0.00
2  4.96e+08 8715.26 | 8564.10    0.0    999     0 |    0.53   4.15   0.07   0.00
2  5.00e+08 8715.26 | 8605.58    0.0    999     0 |    0.53   4.41   0.03   0.00
2  5.03e+08 8715.26 | 8520.82    0.0    999     0 |    0.53   4.18   0.04   0.00
2  5.07e+08 8715.26 | 8567.60    0.0    999     0 |    0.53   4.29   0.04   0.00
2  5.11e+08 8715.26 | 8435.14    0.0    999     0 |    0.53   4.11   0.03   0.00
2  5.14e+08 8715.26 | 8678.62    0.0    999     0 |    0.53   4.21   0.05   0.00
2  5.18e+08 8715.26 | 8688.30    0.0    999     0 |    0.53   4.59   0.03   0.00
2  5.22e+08 8715.26 | 8625.63    0.0    999     0 |    0.53   4.58   0.06   0.00
| UsedTime:   76729 | SavedDir: ./Humanoid_PPO_2
        """
    elif env_name == 'Humanoid.8168':
        env_func = IsaacVecEnv
        env_args = {
            'env_num': 1024,
            'env_name': 'Humanoid',
            'max_step': 1000,
            'state_dim': 108,
            'action_dim': 21,
            'if_discrete': False,
            'target_return': 15000.,

            'sim_device_id': gpu_id,
            'rl_device_id': gpu_id,
        }
        args = Arguments(agent_class, env_func=env_func, env_args=env_args)
        args.eval_env_func = IsaacOneEnv
        args.eval_env_args = {
            'env_num': 1,
            'env_name': 'Humanoid',
            'max_step': 1000,
            'state_dim': 108,
            'action_dim': 21,
            'if_discrete': False,
            'target_return': 15000.,

            'device_id': gpu_id,
        }

        args.reward_scale = 2 ** -4
        args.if_cri_target = False

        args.repeat_times = 2 ** 4
        args.gamma = 0.985
        args.if_use_gae = True
        args.learning_rate = 2 ** -15

        args.target_step = args.max_step
        args.batch_size = args.net_dim * 4
        args.worker_num = 1
        args.if_use_old_traj = False

        args.net_dim = 2 ** 8
        args.batch_size = args.net_dim * 4
        args.repeat_times = 2 ** 4
        args.lambda_gae_adv = 0.85
        args.learning_rate = 2 ** -15

        args.lambda_entropy = 2 ** -6

        args.eval_gap = 2 ** 9
        args.eval_times = 2 ** 1
        args.max_step = int(6e7)

        """
################################################################################
ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
[Error] [carb.windowing-glfw.plugin] GLFW initialization failed.
[Error] [carb.windowing-glfw.plugin] GLFW window creation failed!
[Error] [carb.gym.plugin] Failed to create Window in CreateGymViewerInternal
3  2.02e+06   79.98 |
3  2.02e+06   79.98 |   79.98   16.0     37     3 |    0.14   0.22   0.09   0.00
3  6.04e+06  114.76 |
3  6.04e+06  114.76 |  114.76    5.9     48     2 |    0.15   0.23   0.10   0.00
3  1.00e+07  114.76 |  109.01    0.0     55     0 |    0.16   0.18   0.05   0.00
3  1.40e+07  158.16 |
3  1.40e+07  158.16 |  158.16    8.7     58    13 |    0.17   0.17   0.08   0.00
3  1.80e+07  158.16 |  154.98   13.5     54    14 |    0.18   0.13   0.01   0.00
3  2.19e+07  206.19 |
3  2.19e+07  206.19 |  206.19   23.6     61     7 |    0.19   0.15  -0.00   0.00
3  2.59e+07  206.19 |  192.67    0.0     56     0 |    0.19   0.15   0.00   0.00
3  2.99e+07  299.62 |
3  2.99e+07  299.62 |  299.62   19.0    113     2 |    0.20   0.18   0.00   0.00
3  3.38e+07  476.75 |
3  3.38e+07  476.75 |  476.75  103.1    154    31 |    0.20   0.32   0.01   0.00
3  3.77e+07  511.60 |
3  3.77e+07  511.60 |  511.60    5.6    167    16 |    0.20   0.45   0.00   0.00
3  4.15e+07 1303.89 |
3  4.15e+07 1303.89 | 1303.89  265.4    416   100 |    0.21   0.56  -0.01   0.00
3  4.52e+07 3275.81 |
3  4.52e+07 3275.81 | 3275.81   27.8    999     0 |    0.21   0.73   0.02   0.00
3  4.86e+07 3364.63 |
3  4.86e+07 3364.63 | 3364.63    0.4    999     0 |    0.22   0.77  -0.02   0.00

3  5.21e+07 3606.62 |
3  5.21e+07 3606.62 | 3606.62    2.3    999     0 |    0.23   1.01   0.06   0.00
3  5.56e+07 3900.77 |
3  5.56e+07 3900.77 | 3900.77   16.4    999     0 |    0.24   1.39  -0.00   0.00
3  5.88e+07 4170.07 |
3  5.88e+07 4170.07 | 4170.07   14.7    999     0 |    0.26   1.68   0.04   0.00
3  6.21e+07 4499.06 |
3  6.21e+07 4499.06 | 4499.06    3.0    999     0 |    0.27   1.82   0.05   0.00
3  6.54e+07 4785.18 |
3  6.54e+07 4785.18 | 4785.18   10.3    999     0 |    0.29   1.91   0.00   0.00
3  6.86e+07 5007.28 |
3  6.86e+07 5007.28 | 5007.28   12.8    999     0 |    0.30   2.02   0.01   0.00
3  7.18e+07 5145.29 |
3  7.18e+07 5145.29 | 5145.29   32.6    999     0 |    0.31   2.12   0.04   0.00
3  7.49e+07 5300.70 |
3  7.49e+07 5300.70 | 5300.70    7.0    999     0 |    0.32   2.19   0.03   0.00
3  7.81e+07 5387.67 |
3  7.81e+07 5387.67 | 5387.67    2.3    999     0 |    0.32   2.10   0.02   0.00
3  8.13e+07 5439.57 |
3  8.13e+07 5439.57 | 5439.57   24.0    999     0 |    0.33   2.36   0.01   0.00
3  8.44e+07 5584.72 |
3  8.44e+07 5584.72 | 5584.72   20.7    999     0 |    0.34   2.32   0.01   0.00
3  8.75e+07 5722.92 |
3  8.75e+07 5722.92 | 5722.92    5.4    999     0 |    0.35   2.28   0.01   0.00
3  9.10e+07 5830.65 |
3  9.10e+07 5830.65 | 5830.65   21.9    999     0 |    0.36   2.65   0.00   0.00
3  9.45e+07 5973.10 |
3  9.45e+07 5973.10 | 5973.10    7.6    999     0 |    0.37   2.54  -0.01   0.00
3  9.79e+07 6155.93 |
3  9.79e+07 6155.93 | 6155.93   26.2    999     0 |    0.37   2.65   0.04   0.00
3  1.01e+08 6220.14 |
3  1.01e+08 6220.14 | 6220.14   41.9    999     0 |    0.38   2.51   0.04   0.00
3  1.05e+08 6336.25 |
3  1.05e+08 6336.25 | 6336.25   29.7    999     0 |    0.39   2.56   0.03   0.00
3  1.08e+08 6392.16 |
3  1.08e+08 6392.16 | 6392.16    3.7    999     0 |    0.39   2.78   0.00   0.00
3  1.12e+08 6392.16 | 6348.32    0.0    999     0 |    0.40   2.85   0.02   0.00
3  1.15e+08 6392.16 | 5429.28 1177.1    832   166 |    0.40   2.79   0.03   0.00
3  1.19e+08 6670.74 |
3  1.19e+08 6670.74 | 6670.74   19.2    999     0 |    0.41   2.66   0.03   0.00
3  1.22e+08 6743.09 |
3  1.22e+08 6743.09 | 6743.09   53.1    999     0 |    0.41   3.01   0.01   0.00
3  1.25e+08 6746.77 |
3  1.25e+08 6746.77 | 6746.77    1.4    999     0 |    0.41   2.99   0.05   0.00
3  1.29e+08 6806.96 |
3  1.29e+08 6806.96 | 6806.96   15.9    999     0 |    0.42   3.04   0.05   0.00
3  1.32e+08 6897.12 |
3  1.32e+08 6897.12 | 6897.12   27.3    999     0 |    0.42   2.80   0.04   0.00
3  1.35e+08 6897.12 | 6845.48    0.0    999     0 |    0.42   2.86   0.01   0.00
3  1.39e+08 6932.83 |
3  1.39e+08 6932.83 | 6932.83   21.3    999     0 |    0.43   3.03   0.04   0.00
3  1.42e+08 6932.83 | 6866.63    0.0    999     0 |    0.43   3.60  -0.05   0.00
3  1.46e+08 6944.93 |
3  1.46e+08 6944.93 | 6944.93   11.7    999     0 |    0.43   3.24   0.01   0.00
3  1.49e+08 7016.51 |
3  1.49e+08 7016.51 | 7016.51    9.6    999     0 |    0.44   2.86   0.05   0.00
3  1.52e+08 7067.84 |
3  1.52e+08 7067.84 | 7067.84    1.3    999     0 |    0.44   3.14  -0.00   0.00
3  1.56e+08 7067.84 | 7003.16    0.0    999     0 |    0.44   2.96   0.07   0.00
3  1.59e+08 7129.56 |
3  1.59e+08 7129.56 | 7129.56    7.9    999     0 |    0.44   3.30   0.02   0.00
3  1.62e+08 7150.48 |
3  1.62e+08 7150.48 | 7150.48    3.7    999     0 |    0.45   3.43  -0.01   0.00
3  1.66e+08 7150.48 | 7147.57   38.8    999     0 |    0.45   3.44  -0.00   0.00
3  1.69e+08 7222.12 |
3  1.69e+08 7222.12 | 7222.12   11.4    999     0 |    0.45   3.29   0.02   0.00
3  1.72e+08 7222.12 | 7190.09    0.0    999     0 |    0.45   3.46  -0.02   0.00
3  1.76e+08 7322.86 |
3  1.76e+08 7322.86 | 7322.86    4.1    999     0 |    0.45   3.29   0.04   0.00
3  1.79e+08 7322.86 | 7314.01    0.0    999     0 |    0.46   3.15   0.04   0.00
3  1.82e+08 7322.86 | 7307.63   34.4    999     0 |    0.46   2.98   0.04   0.00
3  1.86e+08 7368.63 |
3  1.86e+08 7368.63 | 7368.63    6.3    999     0 |    0.46   2.89   0.06   0.00
3  1.89e+08 7396.53 |
3  1.89e+08 7396.53 | 7396.53   17.5    999     0 |    0.46   3.22   0.05   0.00
3  1.92e+08 7396.53 | 7375.49    0.0    999     0 |    0.46   3.48  -0.00   0.00
3  1.96e+08 7429.27 |
3  1.96e+08 7429.27 | 7429.27   27.1    999     0 |    0.46   3.11   0.04   0.00
3  1.99e+08 7429.27 | 7385.12    0.0    999     0 |    0.46   3.33   0.05   0.00
3  2.02e+08 7429.27 | 7426.69    7.1    999     0 |    0.46   3.19   0.05   0.00
3  2.06e+08 7429.39 |
3  2.06e+08 7429.39 | 7429.39   22.6    999     0 |    0.47   2.89   0.06   0.00
3  2.09e+08 7469.16 |
3  2.09e+08 7469.16 | 7469.16   22.3    999     0 |    0.47   3.17  -0.00   0.00
3  2.12e+08 7469.16 | 7445.96    0.0    999     0 |    0.47   3.66  -0.01   0.00
3  2.16e+08 7485.55 |
3  2.16e+08 7485.55 | 7485.55   80.2    999     0 |    0.47   3.30   0.03   0.00
3  2.19e+08 7485.55 | 7454.81    0.0    999     0 |    0.47   3.27   0.05   0.00
3  2.22e+08 7485.55 | 7459.73   92.0    999     0 |    0.47   3.55  -0.01   0.00
3  2.25e+08 7612.16 |
3  2.25e+08 7612.16 | 7612.16   49.4    999     0 |    0.47   3.34   0.04   0.00
3  2.29e+08 7647.53 |
3  2.29e+08 7647.53 | 7647.53   10.2    999     0 |    0.47   3.67  -0.02   0.00
3  2.32e+08 7659.38 |
3  2.32e+08 7659.38 | 7659.38   31.3    999     0 |    0.48   3.11   0.07   0.00
3  2.35e+08 7684.98 |
3  2.35e+08 7684.98 | 7684.98   29.2    999     0 |    0.48   3.43   0.01   0.00
3  2.38e+08 7695.20 |
3  2.38e+08 7695.20 | 7695.20    9.3    999     0 |    0.48   3.31   0.04   0.00
3  2.41e+08 7716.73 |
3  2.41e+08 7716.73 | 7716.73   12.2    999     0 |    0.48   3.35   0.02   0.00
3  2.45e+08 7730.91 |
3  2.45e+08 7730.91 | 7730.91    3.0    999     0 |    0.48   3.51  -0.01   0.00
3  2.48e+08 7730.91 | 7720.90    0.0    999     0 |    0.48   3.29   0.03   0.00
3  2.51e+08 7751.88 |
3  2.51e+08 7751.88 | 7751.88    6.1    999     0 |    0.48   3.33   0.00   0.00
3  2.55e+08 7788.04 |
3  2.55e+08 7788.04 | 7788.04   10.6    999     0 |    0.48   3.22   0.06   0.00
3  2.58e+08 7788.04 | 7784.09    0.0    999     0 |    0.49   3.63  -0.01   0.00
3  2.61e+08 7788.04 | 7766.73   64.4    999     0 |    0.49   3.28   0.04   0.00
3  2.64e+08 7808.78 |
3  2.64e+08 7808.78 | 7808.78    3.8    999     0 |    0.49   3.58   0.05   0.00
3  2.68e+08 7808.78 | 7792.78   25.9    999     0 |    0.49   3.21   0.01   0.00
3  2.71e+08 7808.78 | 7804.41    0.0    999     0 |    0.49   3.25   0.04   0.00
3  2.74e+08 7827.40 |
3  2.74e+08 7827.40 | 7827.40   58.4    999     0 |    0.49   3.93  -0.02   0.00
3  2.78e+08 7893.99 |
3  2.78e+08 7893.99 | 7893.99    1.9    999     0 |    0.49   3.67   0.02   0.00
3  2.81e+08 7893.99 | 7846.65    0.0    999     0 |    0.49   3.42   0.02   0.00
3  2.84e+08 7893.99 | 7821.12    0.0    999     0 |    0.49   3.78  -0.04   0.00
3  2.88e+08 7893.99 | 7855.05    0.0    999     0 |    0.49   3.57   0.04   0.00
3  2.91e+08 7893.99 | 7825.09    0.0    999     0 |    0.49   3.41   0.03   0.00
3  2.93e+08 7893.99 | 7879.51    0.0    999     0 |    0.49   3.31   0.02   0.00
3  2.96e+08 7893.99 | 7823.53    0.0    999     0 |    0.49   3.47   0.07   0.00
3  2.99e+08 7893.99 | 7878.77   37.2    999     0 |    0.49   3.68  -0.04   0.00
3  3.02e+08 7893.99 | 7827.60    0.0    999     0 |    0.49   3.52   0.03   0.00
3  3.05e+08 7893.99 | 7712.52    0.0    999     0 |    0.50   3.44   0.02   0.00
3  3.08e+08 7930.73 |
3  3.08e+08 7930.73 | 7930.73   23.6    999     0 |    0.50   3.68   0.02   0.00
3  3.11e+08 7930.73 | 7904.09   60.4    999     0 |    0.50   3.42   0.02   0.00
3  3.13e+08 7930.73 | 7923.25    0.0    999     0 |    0.50   3.72   0.02   0.00
3  3.16e+08 7968.25 |
3  3.16e+08 7968.25 | 7968.25   13.7    999     0 |    0.50   3.43   0.01   0.00
3  3.19e+08 7968.25 | 7915.60    0.0    999     0 |    0.50   3.58   0.02   0.00
3  3.22e+08 7968.25 | 7966.22    0.0    999     0 |    0.50   3.92   0.03   0.00
3  3.25e+08 7968.25 | 7945.57   50.4    999     0 |    0.50   3.25   0.04   0.00
3  3.28e+08 7970.02 |
3  3.28e+08 7970.02 | 7970.02   74.7    999     0 |    0.50   3.72   0.01   0.00
3  3.31e+08 8040.09 |
3  3.31e+08 8040.09 | 8040.09    3.2    999     0 |    0.50   3.65   0.05   0.00
3  3.34e+08 8040.87 |
3  3.34e+08 8040.87 | 8040.87    8.2    999     0 |    0.50   3.43   0.06   0.00
3  3.36e+08 8062.93 |
3  3.36e+08 8062.93 | 8062.93   16.6    999     0 |    0.50   3.43   0.04   0.00
3  3.39e+08 8078.66 |
3  3.39e+08 8078.66 | 8078.66    0.9    999     0 |    0.50   3.47   0.06   0.00
3  3.42e+08 8078.66 | 8044.82    0.0    999     0 |    0.50   3.22   0.06   0.00
3  3.45e+08 8078.66 | 8022.24    0.0    999     0 |    0.50   3.49   0.02   0.00
3  3.48e+08 8078.66 | 8058.88   26.3    999     0 |    0.50   3.43   0.02   0.00
3  3.51e+08 8078.66 | 7974.26  108.1    999     0 |    0.51   3.41   0.06   0.00
3  3.54e+08 8083.05 |
3  3.54e+08 8083.05 | 8083.05   24.0    999     0 |    0.51   3.58   0.04   0.00
3  3.57e+08 8083.05 | 8063.05    0.0    999     0 |    0.51   3.28   0.04   0.00
3  3.60e+08 8083.05 | 7990.97  109.2    999     0 |    0.51   3.55   0.03   0.00
3  3.64e+08 8122.19 |
3  3.64e+08 8122.19 | 8122.19    8.8    999     0 |    0.51   3.71   0.03   0.00
3  3.67e+08 8122.19 | 8104.86    0.0    999     0 |    0.51   3.71   0.04   0.00
3  3.70e+08 8122.19 | 7934.19    0.0    999     0 |    0.51   3.85   0.03   0.00
3  3.73e+08 8122.19 | 8114.94   51.4    999     0 |    0.51   3.58   0.03   0.00
3  3.76e+08 8128.53 |
3  3.76e+08 8128.53 | 8128.53   16.7    999     0 |    0.51   3.66   0.04   0.00
3  3.80e+08 8168.30 |
3  3.80e+08 8168.30 | 8168.30   11.5    999     0 |    0.51   3.92   0.02   0.00
3  3.83e+08 8168.30 | 8136.32    0.0    999     0 |    0.51   3.72   0.04   0.00
3  3.86e+08 8168.30 | 8103.20    0.0    999     0 |    0.51   3.47   0.05   0.00
3  3.89e+08 8168.30 | 8160.08    0.0    999     0 |    0.51   3.72   0.05   0.00
| UsedTime:   67227 | SavedDir: ./Humanoid_PPO_3
| Learner: Save in ./Humanoid_PPO_3
        """
    elif env_name == 'Ant.8976  args.target_step = args.max_step':
        env_func = IsaacVecEnv
        env_args = {
            'env_num': 1024,
            'env_name': 'Ant',
            'max_step': 1000,
            'state_dim': 60,
            'action_dim': 8,
            'if_discrete': False,
            'target_return': 15000.,

            'sim_device_id': gpu_id,
            'rl_device_id': gpu_id,
        }
        args = Arguments(agent_class, env_func=env_func, env_args=env_args)
        args.eval_env_func = IsaacOneEnv
        args.eval_env_args = {
            'env_num': 1,
            'env_name': 'Ant',
            'max_step': 1000,
            'state_dim': 60,
            'action_dim': 8,
            'if_discrete': False,
            'target_return': 15000.,

            'device_id': gpu_id,
        }

        args.reward_scale = 2 ** -4
        args.if_cri_target = False

        args.target_step = args.max_step

        args.target_step = args.max_step
        args.worker_num = 1

        args.net_dim = 2 ** 8
        args.batch_size = args.net_dim * 4
        args.repeat_times = 2 ** 4
        args.gamma = 0.985
        args.lambda_gae_adv = 0.9
        args.if_use_gae = True
        args.learning_rate = 2 ** -15

        args.lambda_entropy = 0.001

        args.eval_gap = 2 ** 9
        args.eval_times = 2 ** 1
        args.max_step = int(6e7)
        """
        ################################################################################
ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
[Error] [carb.windowing-glfw.plugin] GLFW initialization failed.
[Error] [carb.windowing-glfw.plugin] GLFW window creation failed!
[Error] [carb.gym.plugin] Failed to create Window in CreateGymViewerInternal
5  1.49e+06  808.82 |
5  1.49e+06  808.82 |  808.82    0.4    999     0 |    0.03   0.60  -0.04   0.00
5  4.80e+06  903.63 |
5  4.80e+06  903.63 |  903.63  111.8    999     0 |    0.07   0.71   0.03   0.00
5  8.38e+06 1831.48 |
5  8.38e+06 1831.48 | 1831.48 1187.1    657   342 |    0.12   1.03   0.03   0.00
5  1.18e+07 3282.60 |
5  1.18e+07 3282.60 | 3282.60 1072.1    763   236 |    0.17   1.48  -0.01   0.00
5  1.52e+07 3716.26 |
5  1.52e+07 3716.26 | 3716.26 1319.4    801   198 |    0.22   1.85   0.03   0.00
5  1.86e+07 5580.15 |
5  1.86e+07 5580.15 | 5580.15    8.2    999     0 |    0.26   2.18   0.05   0.00
5  2.20e+07 6114.60 |
5  2.20e+07 6114.60 | 6114.60   46.9    999     0 |    0.29   2.53  -0.02   0.00
5  2.52e+07 6114.60 | 3663.18    0.0    675     0 |    0.32   2.78   0.03   0.00
5  2.89e+07 6589.90 |
5  2.89e+07 6589.90 | 6589.90  119.5    999     0 |    0.35   2.88  -0.03   0.00
5  3.26e+07 6837.26 |
5  3.26e+07 6837.26 | 6837.26    3.0    999     0 |    0.37   3.18  -0.02   0.00
5  3.63e+07 7234.19 |
5  3.63e+07 7234.19 | 7234.19    5.8    999     0 |    0.40   3.36   0.04   0.00
5  3.99e+07 7234.19 | 7143.61  458.1    999     0 |    0.41   3.31   0.06   0.00
5  4.36e+07 7735.25 |
5  4.36e+07 7735.25 | 7735.25   13.1    999     0 |    0.43   3.46   0.05   0.00
5  4.72e+07 8271.64 |
5  4.72e+07 8271.64 | 8271.64   99.0    999     0 |    0.45   3.57   0.04   0.00
5  5.09e+07 8271.64 | 8038.39  394.9    999     0 |    0.46   3.71   0.05   0.00
5  5.40e+07 8271.64 | 8226.26    0.0    999     0 |    0.46   4.13  -0.03   0.00
5  5.72e+07 8579.48 |
5  5.72e+07 8579.48 | 8579.48   77.3    999     0 |    0.48   4.08   0.04   0.00
5  6.09e+07 8579.48 | 6753.04 2174.2    812   187 |    0.49   4.00   0.05   0.00
5  6.45e+07 8976.57 |
5  6.45e+07 8976.57 | 8976.57   39.5    999     0 |    0.50   4.52  -0.01   0.00
| UsedTime:   10804 | SavedDir: ./Ant_PPO_5
| Learner: Save in ./Ant_PPO_5

        """
    elif env_name == 'Ant.13053  args.target_step = args.max_step * 2':
        env_func = IsaacVecEnv
        env_args = {
            'env_num': 1024,
            'env_name': 'Ant',
            'max_step': 1000,
            'state_dim': 60,
            'action_dim': 8,
            'if_discrete': False,
            'target_return': 15000.,

            'sim_device_id': gpu_id,
            'rl_device_id': gpu_id,
        }
        args = Arguments(agent_class, env_func=env_func, env_args=env_args)
        args.eval_env_func = IsaacOneEnv
        args.eval_env_args = {
            'env_num': 1,
            'env_name': 'Ant',
            'max_step': 1000,
            'state_dim': 60,
            'action_dim': 8,
            'if_discrete': False,
            'target_return': 15000.,

            'device_id': gpu_id,
        }

        args.reward_scale = 2 ** -4
        args.if_cri_target = False

        args.target_step = args.max_step

        args.target_step = args.max_step * 2
        args.worker_num = 1

        args.net_dim = 2 ** 8
        args.batch_size = args.net_dim * 4
        args.repeat_times = 2 ** 4
        args.gamma = 0.985
        args.lambda_gae_adv = 0.9
        args.if_use_gae = True
        args.learning_rate = 2 ** -15

        args.lambda_entropy = 0.001

        args.eval_gap = 2 ** 9
        args.eval_times = 2 ** 1
        args.max_step = int(6e7)

        """
################################################################################
ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
[Error] [carb.windowing-glfw.plugin] GLFW initialization failed.
[Error] [carb.windowing-glfw.plugin] GLFW window creation failed!
[Error] [carb.gym.plugin] Failed to create Window in CreateGymViewerInternal
3  3.51e+06  870.08 |
3  3.51e+06  870.08 |  870.08   48.9    999     0 |    0.03   0.55   0.08   0.00
3  6.91e+06  870.08 |  864.84    0.0    999     0 |    0.04   0.53   0.03   0.00
3  1.03e+07  870.08 |  866.28    0.0    999     0 |    0.05   0.56   0.07   0.00
3  1.53e+07 1473.76 |
3  1.53e+07 1473.76 | 1473.76  482.1    999     0 |    0.08   0.71   0.02   0.00
3  2.02e+07 1473.76 |  766.06    0.0    281     0 |    0.11   0.86   0.00   0.00
3  2.51e+07 2968.52 |
3  2.51e+07 2968.52 | 2968.52  523.5    926    74 |    0.15   1.19   0.02   0.00
3  3.01e+07 2968.52 | 1292.62    0.0    350     0 |    0.18   1.47  -0.02   0.00
3  3.48e+07 2968.52 | 2532.91 2269.9    574   426 |    0.21   1.53   0.03   0.00
3  3.96e+07 5153.81 |
3  3.96e+07 5153.81 | 5153.81  359.0    999     0 |    0.24   1.84   0.00   0.00
3  4.43e+07 5153.81 | 4071.68 1694.3    724   274 |    0.27   2.02   0.01   0.00
3  4.90e+07 5903.41 |
3  4.90e+07 5903.41 | 5903.41   32.7    999     0 |    0.29   2.23  -0.00   0.00
3  5.36e+07 5903.41 | 5735.61    0.0    999     0 |    0.31   2.29   0.04   0.00
3  5.83e+07 5903.41 | 4924.40    0.0    999     0 |    0.33   2.22  -0.01   0.00
3  6.30e+07 5903.41 | 5045.77 1460.3    792   208 |    0.35   2.46   0.05   0.00
3  6.76e+07 6712.72 |
3  6.76e+07 6712.72 | 6712.72  146.9    999     0 |    0.36   2.21   0.07   0.00
3  7.23e+07 7023.30 |
3  7.23e+07 7023.30 | 7023.30  272.5    999     0 |    0.38   2.45   0.05   0.00
3  7.69e+07 7386.69 |
3  7.69e+07 7386.69 | 7386.69  149.4    999     0 |    0.39   2.62   0.05   0.00
3  8.15e+07 7386.69 | 7362.49    0.0    999     0 |    0.40   2.48   0.05   0.00
3  8.61e+07 7386.69 | 7281.17    0.0    999     0 |    0.41   2.75   0.04   0.00
3  9.08e+07 7700.03 |
3  9.08e+07 7700.03 | 7700.03  147.0    999     0 |    0.42   2.89  -0.01   0.00
3  9.54e+07 8166.52 |
3  9.54e+07 8166.52 | 8166.52  275.2    999     0 |    0.43   2.83   0.02   0.00
3  1.00e+08 8166.52 | 7026.17    0.0    999     0 |    0.44   2.99  -0.02   0.00
3  1.05e+08 8166.52 | 8081.64    0.0    999     0 |    0.45   3.31  -0.07   0.00
3  1.09e+08 8933.38 |
3  1.09e+08 8933.38 | 8933.38  127.9    999     0 |    0.46   2.92   0.04   0.00
3  1.14e+08 8933.38 | 8892.71   92.9    999     0 |    0.47   2.96   0.05   0.00
3  1.19e+08 8933.38 | 8923.14    0.0    999     0 |    0.48   3.19   0.03   0.00
3  1.23e+08 8933.38 | 8623.99    0.0    999     0 |    0.49   2.94   0.06   0.00
3  1.28e+08 9135.87 |
3  1.28e+08 9135.87 | 9135.87  187.3    999     0 |    0.49   3.37   0.05   0.00
3  1.33e+08 9199.12 |
3  1.33e+08 9199.12 | 9199.12   77.4    999     0 |    0.50   3.35   0.02   0.00
3  1.37e+08 9236.54 |
3  1.37e+08 9236.54 | 9236.54  190.5    999     0 |    0.51   3.27   0.02   0.00
3  1.42e+08 9482.46 |
3  1.42e+08 9482.46 | 9482.46  171.7    999     0 |    0.52   3.36   0.03   0.00
3  1.46e+08 9482.46 | 8797.04    0.0    999     0 |    0.52   3.58   0.01   0.00
3  1.51e+08 9608.14 |
3  1.51e+08 9608.14 | 9608.14  312.1    999     0 |    0.53   3.72   0.02   0.00
3  1.56e+08 9608.14 | 9444.38    0.0    999     0 |    0.54   3.55  -0.00   0.00
3  1.60e+08 9852.31 |
3  1.60e+08 9852.31 | 9852.31   74.9    999     0 |    0.54   3.60   0.03   0.00
3  1.65e+08 9852.31 | 8701.84    0.0    999     0 |    0.55   3.55   0.00   0.00
3  1.70e+08 9852.31 | 9485.60  468.9    999     0 |    0.56   3.83  -0.01   0.00
3  1.74e+0810166.52 |
3  1.74e+0810166.52 |10166.52   53.0    999     0 |    0.56   3.36   0.04   0.00
3  1.79e+0810383.81 |
3  1.79e+0810383.81 |10383.81  210.0    999     0 |    0.56   3.78   0.02   0.00
3  1.83e+0810383.81 |10362.63  128.2    999     0 |    0.57   3.91   0.01   0.00
3  1.88e+0810669.93 |
3  1.88e+0810669.93 |10669.93  107.7    999     0 |    0.57   3.42   0.04   0.00
3  1.93e+0810669.93 |10636.93    0.0    999     0 |    0.58   3.89   0.04   0.00
3  1.97e+0810669.93 |10377.79    0.0    999     0 |    0.59   3.48   0.05   0.00
3  2.02e+0810669.93 |10452.28    0.0    999     0 |    0.59   4.23  -0.01   0.00
3  2.07e+0810669.93 |10615.98    0.0    999     0 |    0.59   3.99   0.05   0.00
3  2.11e+0810843.09 |
3  2.11e+0810843.09 |10843.09  101.2    999     0 |    0.60   4.01   0.01   0.00
3  2.16e+0810843.09 |10040.34    0.0    999     0 |    0.60   4.01  -0.03   0.00
3  2.21e+0811341.61 |
3  2.21e+0811341.61 |11341.61  183.3    999     0 |    0.61   4.46  -0.03   0.00
3  2.25e+0811341.61 |11335.21    0.0    999     0 |    0.61   4.11   0.04   0.00
3  2.30e+0811341.61 |10538.58    0.0    999     0 |    0.61   4.31  -0.04   0.00
3  2.35e+0811341.61 |10964.52  379.4    999     0 |    0.62   4.45  -0.01   0.00
3  2.39e+0811341.61 |10614.99    0.0    999     0 |    0.63   4.16  -0.02   0.00
3  2.44e+0811341.61 | 9714.93    0.0    999     0 |    0.63   4.37  -0.02   0.00
3  2.48e+0811341.61 |11269.16    0.0    999     0 |    0.63   3.82   0.03   0.00
3  2.53e+0811628.54 |
3  2.53e+0811628.54 |11628.54   44.4    999     0 |    0.63   4.08   0.02   0.00
3  2.58e+0811630.72 |
3  2.58e+0811630.72 |11630.72   20.9    999     0 |    0.64   4.17   0.04   0.00
3  2.62e+0811829.33 |
3  2.62e+0811829.33 |11829.33  146.9    999     0 |    0.64   4.99  -0.03   0.00
3  2.67e+0811897.12 |
3  2.67e+0811897.12 |11897.12  227.5    999     0 |    0.64   4.72  -0.01   0.00
3  2.71e+0811897.12 |11084.75 1127.8    999     0 |    0.64   4.36  -0.00   0.00
3  2.76e+0811897.12 |11294.17    0.0    999     0 |    0.64   4.25   0.04   0.00
3  2.81e+0811952.50 |
3  2.81e+0811952.50 |11952.50  113.2    999     0 |    0.65   4.59   0.01   0.00
3  2.85e+0811952.50 |11743.20    0.0    999     0 |    0.66   4.21   0.05   0.00
3  2.90e+0811952.50 |11822.69    0.0    999     0 |    0.66   4.29   0.01   0.00
3  2.94e+0812139.96 |
3  2.94e+0812139.96 |12139.96   35.7    999     0 |    0.66   4.81  -0.00   0.00
3  2.99e+0812139.96 |11856.37    0.0    999     0 |    0.66   4.63  -0.03   0.00
3  3.04e+0812139.96 |11898.53    0.0    999     0 |    0.66   4.28   0.03   0.00
3  3.08e+0812139.96 |11921.20    0.0    999     0 |    0.67   4.62  -0.03   0.00
3  3.13e+0812139.96 |11490.30    0.0    999     0 |    0.67   4.09   0.05   0.00
3  3.18e+0812139.96 |11730.25    0.0    999     0 |    0.67   4.35   0.02   0.00
3  3.22e+0812139.96 |11718.74    0.0    999     0 |    0.66   5.36  -0.05   0.00
3  3.27e+0812139.96 |11973.67    0.0    999     0 |    0.67   3.89   0.06   0.00
3  3.31e+0812292.27 |
3  3.31e+0812292.27 |12292.27   12.1    999     0 |    0.68   4.62   0.00   0.00
3  3.36e+0812675.97 |
3  3.36e+0812675.97 |12675.97   14.0    999     0 |    0.68   4.31   0.03   0.00
3  3.41e+0812675.97 |12664.60    0.0    999     0 |    0.69   4.39  -0.01   0.00
3  3.45e+0812675.97 |12486.84    0.0    999     0 |    0.69   4.38   0.04   0.00
3  3.50e+0812675.97 |12179.20    0.0    999     0 |    0.69   4.50   0.00   0.00
3  3.55e+0812800.73 |
3  3.55e+0812800.73 |12800.73  131.6    999     0 |    0.69   4.63   0.02   0.00
3  3.59e+0812931.73 |
3  3.59e+0812931.73 |12931.73  147.5    999     0 |    0.69   4.85  -0.00   0.00
3  3.64e+0812931.73 | 7238.76    0.0    604     0 |    0.70   4.79   0.03   0.00
3  3.68e+0812931.73 |10354.56    0.0    999     0 |    0.70   4.66   0.01   0.00
3  3.73e+0813053.90 |
3  3.73e+0813053.90 |13053.90   53.5    999     0 |    0.70   5.15  -0.00   0.00
3  3.78e+0813053.90 |12578.21    0.0    999     0 |    0.70   4.36   0.05   0.00
3  3.82e+0813053.90 |12382.82    0.0    999     0 |    0.70   4.47   0.04   0.00
3  3.87e+0813053.90 |12778.96    0.0    999     0 |    0.71   4.70   0.01   0.00
3  3.92e+0813053.90 |12984.50    0.0    999     0 |    0.71   4.92   0.01   0.00
3  3.96e+0813053.90 |12746.77    0.0    999     0 |    0.71   4.68   0.01   0.00
3  4.01e+0813053.90 |12765.69  331.5    999     0 |    0.72   4.64   0.00   0.00
3  4.05e+0813053.90 |12913.30  198.2    999     0 |    0.72   4.88   0.03   0.00
3  4.10e+0813053.90 |11238.58    0.0    999     0 |    0.72   4.62   0.04   0.00
3  4.15e+0813053.90 |12863.71    0.0    999     0 |    0.71   4.73   0.04   0.00
        """
    elif env_name == 'ShadowHand':
        env_func = IsaacVecEnv
        env_num = 512
        max_step = 600

        env_args = {
            'env_num': env_num,
            'env_name': env_name,
            'max_step': max_step,
            'state_dim': 211,
            'action_dim': 20,
            'if_discrete': False,
            'target_return': 15000.,

            'sim_device_id': gpu_id,
            'rl_device_id': gpu_id,
        }
        args = Arguments(agent_class, env_func=env_func, env_args=env_args)
        args.eval_env_func = IsaacOneEnv
        args.eval_env_args = {
            'env_num': 1,
            'env_name': env_name,
            'max_step': max_step,
            'state_dim': 211,
            'action_dim': 20,
            'if_discrete': False,
            'target_return': 15000.,

            'device_id': gpu_id,
        }

        args.reward_scale = 2 ** -1
        args.if_cri_target = False

        args.net_dim = 2 ** 8
        args.num_layer = 3
        args.batch_size = int(args.net_dim * 2)
        args.repeat_times = 2 ** 4
        args.lambda_entropy = 0.05

        args.clip_grad_norm = 0.5
        args.gamma = 0.99
        args.target_step = args.max_step * 2
        args.if_use_gae = True
        args.ratio_clip = 0.5
        args.lambda_gae_adv = 0.90
        args.learning_rate = 2 ** -15

        args.if_use_old_traj = False
        args.worker_num = 1

        args.eval_gap = 2 ** 8
        args.eval_times = 2 ** 1
        args.max_step = int(2e8)
    else:
        raise ValueError('env_name:', env_name)

    args.learner_gpus = gpu_id
    args.random_seed += gpu_id

    if_check = 0
    if if_check:
        train_and_evaluate(args)
    else:
        train_and_evaluate_mp(args)


def demo_sac(gpu_id, drl_id, env_id):
    env_name = ['Ant',
                'Humanoid',
                'ShadowHand'][env_id]
    agent_class = [AgentTD3, AgentSAC, AgentReSAC, ][drl_id]

    if env_name == 'Ant':
        env_num = 2 ** 9
        env_func = IsaacVecEnv
        env_args = {
            'env_num': env_num,
            'env_name': 'Ant',
            'max_step': 1000,
            'state_dim': 60,
            'action_dim': 8,
            'if_discrete': False,
            'target_return': 15000.,

            'sim_device_id': gpu_id,
            'rl_device_id': gpu_id,
        }
        args = Arguments(agent_class, env_func=env_func, env_args=env_args)
        args.eval_env_func = IsaacOneEnv
        args.eval_env_args = {
            'env_num': 1,
            'env_name': 'Ant',
            'max_step': 1000,
            'state_dim': 60,
            'action_dim': 8,
            'if_discrete': False,
            'target_return': 15000.,

            'device_id': gpu_id,
        }

        args.reward_scale = 2 ** -3
        args.if_cri_target = False

        args.net_dim = 2 ** 8
        args.batch_size = args.net_dim * 4
        args.target_step = args.max_step
        args.max_memo = env_num * args.max_step * 2
        args.repeat_times = 2 ** -2
        args.gamma = 0.985
        args.learning_rate = 2 ** -15

        args.worker_num = 1

        args.eval_gap = 2 ** 9
        args.eval_times = 2 ** 1
        args.max_step = int(6e7)
        """
        ################################################################################
ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
[Error] [carb.windowing-glfw.plugin] GLFW initialization failed.
[Error] [carb.windowing-glfw.plugin] GLFW window creation failed!
[Error] [carb.gym.plugin] Failed to create Window in CreateGymViewerInternal
5  1.45e+06  715.30 |
5  1.45e+06  715.30 |  715.30    0.8    999     0 |    0.03   0.65  -0.00   0.00
5  5.25e+06  813.08 |
5  5.25e+06  813.08 |  813.08    1.5    999     0 |    0.07   0.71   0.07   0.00
5  8.94e+06 1509.14 |
5  8.94e+06 1509.14 | 1509.14 1221.1    600   400 |    0.12   1.01   0.05   0.00
5  1.26e+07 3632.72 |
5  1.26e+07 3632.72 | 3632.72  464.7    904    95 |    0.16   1.34   0.01   0.00
5  1.61e+07 4859.70 |
5  1.61e+07 4859.70 | 4859.70   41.7    999     0 |    0.21   1.88   0.02   0.00
5  1.94e+07 5700.69 |
5  1.94e+07 5700.69 | 5700.69  402.1    999     0 |    0.26   2.32  -0.01   0.00
5  2.27e+07 6393.19 |
5  2.27e+07 6393.19 | 6393.19  363.5    999     0 |    0.30   2.53  -0.00   0.00
5  2.59e+07 6393.19 | 5507.23 1342.6    844   155 |    0.33   2.72   0.04   0.00
5  2.92e+07 6393.19 | 4640.38    0.0    717     0 |    0.36   3.01   0.06   0.00
5  3.29e+07 7456.53 |
5  3.29e+07 7456.53 | 7456.53  367.6    999     0 |    0.39   3.08   0.04   0.00
5  3.67e+07 7895.77 |
5  3.67e+07 7895.77 | 7895.77   23.8    999     0 |    0.41   3.70  -0.01   0.00
5  3.99e+07 7895.77 | 7537.12    0.0    999     0 |    0.43   3.43   0.02   0.00
5  4.36e+07 8044.43 |
5  4.36e+07 8044.43 | 8044.43   91.3    999     0 |    0.45   4.14   0.05   0.00
5  4.72e+07 8555.77 |
5  4.72e+07 8555.77 | 8555.77   43.7    999     0 |    0.47   3.70   0.11   0.00
5  5.09e+07 8555.77 | 8500.93    0.0    999     0 |    0.48   3.66   0.05   0.00
5  5.46e+07 9068.44 |
5  5.46e+07 9068.44 | 9068.44   86.5    999     0 |    0.49   3.98   0.04   0.00
5  5.83e+07 9068.44 | 9022.83    0.0    999     0 |    0.51   4.04   0.02   0.00
5  6.20e+07 9268.45 |
5  6.20e+07 9268.45 | 9268.45  102.4    999     0 |    0.51   4.35   0.02   0.00
5  6.52e+07 9268.45 | 8558.61    0.0    999     0 |    0.53   4.70  -0.02   0.00
5  6.89e+07 9268.45 | 9048.96    0.0    999     0 |    0.54   4.87  -0.00   0.00
5  7.25e+07 9782.53 |
5  7.25e+07 9782.53 | 9782.53   59.5    999     0 |    0.54   4.61   0.02   0.00
5  7.57e+07 9782.53 | 9434.72  653.1    999     0 |    0.55   4.80   0.04   0.00
5  7.89e+07 9929.08 |
5  7.89e+07 9929.08 | 9929.08   78.6    999     0 |    0.56   4.59   0.07   0.00
5  8.26e+07 9929.08 | 8626.38 1524.7    906    93 |    0.57   4.79   0.03   0.00
5  8.63e+0710097.79 |
5  8.63e+0710097.79 |10097.79   67.8    999     0 |    0.58   4.80   0.02   0.00
5  9.00e+0710097.79 | 6753.56    0.0    689     0 |    0.58   4.86   0.01   0.00
5  9.37e+0710097.79 | 9906.23    0.0    999     0 |    0.59   4.71   0.03   0.00
5  9.72e+0710097.79 | 9780.64    0.0    999     0 |    0.60   5.20  -0.02   0.00
5  1.01e+0810626.80 |
5  1.01e+0810626.80 |10626.80  184.4    999     0 |    0.61   5.13   0.04   0.00
5  1.04e+0810626.80 | 9408.59    0.0    999     0 |    0.62   5.69  -0.03   0.00
5  1.08e+0810626.80 |10539.27    0.0    999     0 |    0.62   5.03   0.04   0.00
5  1.12e+0810864.20 |
5  1.12e+0810864.20 |10864.20  114.5    999     0 |    0.62   5.86  -0.01   0.00
5  1.15e+0810864.20 |10797.01    0.0    999     0 |    0.63   5.27   0.06   0.00
5  1.19e+0810864.20 |10353.68    0.0    999     0 |    0.64   5.27   0.00   0.00
5  1.22e+0810864.20 |10653.36  462.6    999     0 |    0.63   5.02   0.05   0.00
5  1.26e+0811135.88 |
5  1.26e+0811135.88 |11135.88   30.8    999     0 |    0.63   5.29   0.02   0.00
5  1.30e+0811135.88 |10895.74    0.0    999     0 |    0.64   5.29   0.04   0.00
5  1.33e+0811135.88 |11047.80    0.0    999     0 |    0.65   5.35   0.03   0.00
5  1.37e+0811135.88 |10640.79    0.0    999     0 |    0.65   5.18   0.03   0.00
5  1.41e+0811135.88 |10195.72 1193.0    999     0 |    0.65   5.11   0.01   0.00
5  1.44e+0811135.88 | 9187.88    0.0    999     0 |    0.65   5.32   0.03   0.00
5  1.47e+0811187.77 |
5  1.47e+0811187.77 |11187.77  270.7    999     0 |    0.65   6.05   0.03   0.00
5  1.51e+0811250.55 |
5  1.51e+0811250.55 |11250.55   47.4    999     0 |    0.66   6.06  -0.06   0.00
5  1.55e+0811258.22 |
5  1.55e+0811258.22 |11258.22  265.7    999     0 |    0.67   5.77  -0.07   0.00
5  1.58e+0811258.22 |10042.97    0.0    999     0 |    0.67   4.94   0.03   0.00
5  1.62e+0811258.22 |11129.98    0.0    999     0 |    0.66   5.54   0.05   0.00
5  1.65e+0811258.22 |10736.87  554.5    999     0 |    0.67   5.60  -0.01   0.00
5  1.69e+0811258.22 |10130.68 1243.9    978    22 |    0.67   6.04  -0.02   0.00
5  1.72e+0811313.79 |
5  1.72e+0811313.79 |11313.79  355.1    999     0 |    0.68   4.97   0.07   0.00
5  1.76e+0811313.79 |10586.41 1050.1    999     0 |    0.68   5.55  -0.03   0.00
5  1.80e+0811339.15 |
5  1.80e+0811339.15 |11339.15  144.3    999     0 |    0.68   5.48   0.00   0.00
5  1.83e+0811339.15 |11039.22    0.0    999     0 |    0.68   5.45  -0.02   0.00
5  1.87e+0811537.60 |
5  1.87e+0811537.60 |11537.60    2.8    999     0 |    0.68   5.35   0.01   0.00
5  1.90e+0811837.19 |
5  1.94e+0811837.19 |10861.01    0.0    999     0 |    0.66   5.97   0.00   0.00
5  1.98e+0811837.19 |11585.31    0.0    999     0 |    0.67   5.23   0.05   0.00
5  2.01e+0811837.19 |11501.91  435.5    999     0 |    0.68   6.66  -0.03   0.00
5  2.05e+0811837.19 |11754.03  194.8    999     0 |    0.69   5.84   0.03   0.00
5  2.08e+0811837.19 |11647.83    0.0    999     0 |    0.68   5.33   0.02   0.00
5  2.12e+0811837.19 |11824.40    0.0    999     0 |    0.69   6.11  -0.01   0.00
5  2.16e+0811837.19 | 9849.55    0.0    999     0 |    0.69   5.86  -0.03   0.00
5  2.19e+0811837.19 |11707.01    0.0    999     0 |    0.69   5.90   0.02   0.00
5  2.23e+0811837.19 | 9964.05    0.0    999     0 |    0.69   5.48   0.03   0.00
5  2.26e+0811837.19 |11777.00    0.0    999     0 |    0.68   5.46   0.01   0.00
5  2.30e+0811837.19 |11466.23  525.9    999     0 |    0.67   5.37  -0.02   0.00
5  2.34e+0811837.19 |11501.46    0.0    999     0 |    0.67   5.61   0.00   0.00
5  2.37e+0811837.19 |11641.14    0.0    999     0 |    0.68   5.57   0.02   0.00
5  2.41e+0811837.19 |11531.93    0.0    999     0 |    0.68   5.46   0.01   0.00
5  2.44e+0811837.19 |11611.25    0.0    999     0 |    0.68   4.78   0.07   0.00
5  2.48e+0811837.19 | 9939.56    0.0    999     0 |    0.69   5.54   0.00   0.00
5  2.52e+0811837.19 |11487.50    0.0    999     0 |    0.68   5.24   0.05   0.00
5  2.55e+0811837.19 |11788.89    0.0    999     0 |    0.68   5.25   0.04   0.00
5  2.59e+0811837.19 |11246.41    0.0    999     0 |    0.68   5.00   0.05   0.00
5  2.62e+0811837.19 |11147.01    0.0    999     0 |    0.68   5.63   0.02   0.00
5  2.66e+0811837.19 |10095.05    0.0    999     0 |    0.69   5.57   0.06   0.00
5  2.69e+0811837.19 |10291.63    0.0    999     0 |    0.69   5.42   0.03   0.00
5  2.73e+0811837.19 |11723.41    0.0    999     0 |    0.69   5.48  -0.02   0.00
5  2.77e+0811837.19 |11789.32    0.0    999     0 |    0.69   5.41   0.07   0.00
5  2.80e+0811837.19 |11722.76    0.0    999     0 |    0.69   5.57   0.03   0.00
5  2.84e+0811837.19 |11158.46    0.0    999     0 |    0.68   5.34   0.04   0.00
5  2.87e+0811837.19 |10943.61    0.0    999     0 |    0.69   5.39   0.03   0.00
5  2.91e+0811837.19 |11618.53    0.0    999     0 |    0.68   5.03   0.05   0.00
5  2.95e+0811837.19 |11408.62    0.0    999     0 |    0.69   5.34   0.02   0.00
5  2.99e+0812038.03 |
5  2.99e+0812038.03 |12038.03   91.2    999     0 |    0.70   5.58   0.03   0.00
5  3.02e+0812038.03 |11243.29    0.0    999     0 |    0.69   5.45   0.04   0.00
5  3.06e+0812038.03 |11989.24  111.8    999     0 |    0.69   5.86  -0.01   0.00
5  3.09e+0812038.03 |10490.47 1731.9    940    58 |    0.70   5.29   0.03   0.00
5  3.13e+0812038.03 |11856.33  356.5    999     0 |    0.69   5.94   0.01   0.00
5  3.17e+0812038.03 | 4712.17    0.0    457     0 |    0.69   5.57  -0.01   0.00
5  3.20e+0812038.03 |11649.08    0.0    999     0 |    0.69   5.47   0.05   0.00
5  3.24e+0812038.03 |11829.52    0.0    999     0 |    0.69   5.23   0.02   0.00
5  3.27e+0812038.03 | 4106.64    0.0    457     0 |    0.70   5.49   0.01   0.00
5  3.31e+0812038.03 |11764.93    0.0    999     0 |    0.70   5.41   0.04   0.00
5  3.35e+0812038.03 |11908.82    0.0    999     0 |    0.70   5.02   0.02   0.00
5  3.38e+0812038.03 |11762.90    0.0    999     0 |    0.69   5.27   0.03   0.00
5  3.42e+0812038.03 |11614.01    0.0    999     0 |    0.70   5.57   0.03   0.00
5  3.45e+0812038.03 |11897.09    0.0    999     0 |    0.70   5.72   0.05   0.00
5  3.49e+0812038.03 | 6554.87    0.0    617     0 |    0.69   5.51   0.02   0.00
5  3.52e+0812038.03 |11917.55    0.0    999     0 |    0.70   5.86   0.01   0.00
5  3.56e+0812038.03 |11911.26    0.0    999     0 |    0.70   5.58  -0.03   0.00
5  3.60e+0812038.03 | 4371.31    0.0    654     0 |    0.70   5.35   0.01   0.00
5  3.63e+0812038.03 |11799.74    0.0    999     0 |    0.69   5.67   0.01   0.00
5  3.67e+0812282.57 |
5  3.67e+0812282.57 |12282.57   55.5    999     0 |    0.70   5.82  -0.01   0.00
5  3.70e+0812282.57 |11976.41    0.0    999     0 |    0.70   5.90  -0.02   0.00
5  3.74e+0812282.57 |11931.33    0.0    999     0 |    0.71   5.48   0.04   0.00
5  3.78e+0812282.57 |12255.16   32.2    999     0 |    0.71   6.00   0.02   0.00
5  3.81e+0812282.57 |11734.02    0.0    999     0 |    0.72   5.14   0.02   0.00
5  3.85e+0812282.57 |12210.93    0.0    999     0 |    0.72   5.33   0.05   0.00
5  3.89e+0812282.57 |11950.65    0.0    999     0 |    0.72   5.31   0.05   0.00
5  3.92e+0812282.57 |12060.55  436.2    999     0 |    0.72   5.86   0.03   0.00
5  3.96e+0812282.57 |11988.52    0.0    999     0 |    0.72   5.15   0.02   0.00
5  3.99e+0812282.57 |11983.27    0.0    999     0 |    0.72   5.91   0.06   0.00
5  4.03e+0812282.57 |10438.71    0.0    999     0 |    0.71   5.35   0.04   0.00
5  4.06e+0812282.57 |12034.14    0.0    999     0 |    0.72   5.28   0.04   0.00
5  4.10e+0812282.57 |12131.99    0.0    999     0 |    0.72   5.07   0.02   0.00
5  4.14e+0812282.57 |11892.33    0.0    999     0 |    0.72   5.29  -0.00   0.00
5  4.17e+0812330.35 |
5  4.17e+0812330.35 |12330.35   26.9    999     0 |    0.71   5.84   0.02   0.00
5  4.21e+0812330.35 |10513.44    0.0    999     0 |    0.72   5.17   0.03   0.00
5  4.25e+0812330.35 |10251.97    0.0    999     0 |    0.71   5.39   0.05   0.00
5  4.28e+0812330.35 | 6518.90    0.0    684     0 |    0.71   5.62  -0.01   0.00
5  4.32e+0812330.35 |12324.02    0.0    999     0 |    0.72   5.37   0.05   0.00
| UsedTime:   68499 | SavedDir: ./Ant_PPO_5
        """
    elif env_name == 'Humanoid':
        env_func = IsaacVecEnv
        env_args = {
            'env_num': 1024,
            'env_name': 'Humanoid',
            'max_step': 1000,
            'state_dim': 108,
            'action_dim': 21,
            'if_discrete': False,
            'target_return': 15000.,

            'sim_device_id': gpu_id,
            'rl_device_id': gpu_id,
        }
        args = Arguments(agent_class, env_func=env_func, env_args=env_args)
        args.eval_env_func = IsaacOneEnv
        args.eval_env_args = {
            'env_num': 1,
            'env_name': 'Humanoid',
            'max_step': 1000,
            'state_dim': 108,
            'action_dim': 21,
            'if_discrete': False,
            'target_return': 15000.,

            'device_id': gpu_id,
        }

        args.reward_scale = 2 ** -4
        args.if_cri_target = False

        args.repeat_times = 2 ** 4
        args.gamma = 0.985
        args.if_use_gae = True
        args.learning_rate = 2 ** -15

        args.target_step = args.max_step
        args.batch_size = args.net_dim * 4
        args.worker_num = 1
        args.if_use_old_traj = False
        if gpu_id == 2:
            args.net_dim = 2 ** 9
            args.batch_size = args.net_dim * 8  # todo
            args.repeat_times = 2 ** 5
            args.lambda_gae_adv = 0.85
            args.learning_rate = 2 ** -13
        if gpu_id == 3:
            args.net_dim = 2 ** 8
            args.batch_size = args.net_dim * 4
            args.repeat_times = 2 ** 4
            args.lambda_gae_adv = 0.85
            args.learning_rate = 2 ** -15

        args.lambda_entropy = 2 ** -6

        args.eval_gap = 2 ** 9
        args.eval_times = 2 ** 1
        args.max_step = int(6e7)
    elif env_name == 'Humanoid.8686':
        env_func = IsaacVecEnv
        env_args = {
            'env_num': 1024,
            'env_name': 'Humanoid',
            'max_step': 1000,
            'state_dim': 108,
            'action_dim': 21,
            'if_discrete': False,
            'target_return': 15000.,

            'sim_device_id': gpu_id,
            'rl_device_id': gpu_id,
        }
        args = Arguments(agent_class, env_func=env_func, env_args=env_args)
        args.eval_env_func = IsaacOneEnv
        args.eval_env_args = {
            'env_num': 1,
            'env_name': 'Humanoid',
            'max_step': 1000,
            'state_dim': 108,
            'action_dim': 21,
            'if_discrete': False,
            'target_return': 15000.,

            'device_id': gpu_id,
        }

        args.reward_scale = 2 ** -4
        args.if_cri_target = False

        args.repeat_times = 2 ** 4
        args.gamma = 0.985
        args.if_use_gae = True
        args.learning_rate = 2 ** -15

        args.target_step = args.max_step
        args.batch_size = args.net_dim * 4
        args.worker_num = 1
        args.if_use_old_traj = False
        args.net_dim = 2 ** 9
        args.batch_size = args.net_dim * 8  # todo
        args.repeat_times = 2 ** 5
        args.lambda_gae_adv = 0.85
        args.learning_rate = 2 ** -13

        args.lambda_entropy = 2 ** -6

        args.eval_gap = 2 ** 9
        args.eval_times = 2 ** 1
        args.max_step = int(6e7)

        """
################################################################################
ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
[Error] [carb.windowing-glfw.plugin] GLFW initialization failed.
[Error] [carb.windowing-glfw.plugin] GLFW window creation failed!
[Error] [carb.gym.plugin] Failed to create Window in CreateGymViewerInternal
2  2.02e+06   71.78 |
2  2.02e+06   71.78 |   71.78   12.4     36     2 |    0.14   0.18   0.08   0.00

2  6.02e+06  109.81 |
2  6.02e+06  109.81 |  109.81   26.1     43     1 |    0.16   0.14   0.05   0.00
2  1.10e+07  195.23 |
2  1.10e+07  195.23 |  195.23   25.3     64    12 |    0.17   0.13   0.07   0.00
2  1.60e+07  195.23 |  185.08    0.0     56     0 |    0.18   0.11   0.09   0.00
2  2.09e+07  195.23 |  186.54    0.0     76     0 |    0.19   0.14   0.07   0.00
2  2.58e+07  229.67 |
2  2.58e+07  229.67 |  229.67    3.8     86     4 |    0.20   0.24   0.08   0.00
2  3.07e+07  343.69 |
2  3.07e+07  343.69 |  343.69    0.6    132     2 |    0.21   0.40   0.10   0.00
2  3.55e+07 1679.27 |
2  3.55e+07 1679.27 | 1679.27  201.3    510    72 |    0.22   0.62   0.08   0.00
2  4.02e+07 1679.27 | 1154.88    0.0    301     0 |    0.23   0.93   0.08   0.00
2  4.45e+07 1679.27 | 1623.16    0.0    369     0 |    0.25   1.13   0.08   0.00
2  4.88e+07 3377.29 |
2  4.88e+07 3377.29 | 3377.29 1513.6    694   305 |    0.28   1.35   0.08   0.00
2  5.31e+07 5344.39 |
2  5.31e+07 5344.39 | 5344.39   25.8    999     0 |    0.31   1.76   0.05   0.00
2  5.71e+07 5679.54 |
2  5.71e+07 5679.54 | 5679.54    1.2    999     0 |    0.33   1.91   0.05   0.00
2  6.10e+07 5679.54 | 5602.18    0.0    999     0 |    0.35   1.97   0.07   0.00
2  6.48e+07 6116.60 |
2  6.48e+07 6116.60 | 6116.60   36.2    999     0 |    0.37   2.34   0.08   0.00
2  6.85e+07 6295.71 |
2  6.85e+07 6295.71 | 6295.71    9.1    999     0 |    0.38   2.42   0.04   0.00
2  7.26e+07 6422.94 |
2  7.26e+07 6422.94 | 6422.94   26.4    999     0 |    0.39   2.56   0.02   0.00
2  7.66e+07 6508.94 |
2  7.66e+07 6508.94 | 6508.94   50.4    999     0 |    0.40   2.92   0.04   0.00
2  8.07e+07 6632.57 |
2  8.07e+07 6632.57 | 6632.57   17.9    999     0 |    0.41   2.67   0.06   0.00
2  8.47e+07 6736.83 |
2  8.47e+07 6736.83 | 6736.83   76.0    999     0 |    0.42   2.87   0.02   0.00
2  8.88e+07 6913.29 |
2  8.88e+07 6913.29 | 6913.29    3.4    999     0 |    0.42   2.93   0.05   0.00
2  9.28e+07 6941.66 |
2  9.28e+07 6941.66 | 6941.66    1.2    999     0 |    0.42   2.91   0.08   0.00
2  9.68e+07 6941.66 | 5882.48 1115.5    850   148 |    0.43   2.85   0.07   0.00
2  1.01e+08 6941.66 | 6615.23    0.0    946     0 |    0.43   2.96   0.04   0.00
2  1.05e+08 7056.03 |
2  1.05e+08 7056.03 | 7056.03   53.6    999     0 |    0.44   2.97   0.06   0.00
2  1.09e+08 7056.03 | 6943.94    0.0    999     0 |    0.44   3.03   0.05   0.00
2  1.13e+08 7186.16 |
2  1.13e+08 7186.16 | 7186.16   18.0    999     0 |    0.45   2.98   0.08   0.00
2  1.17e+08 7186.55 |
2  1.17e+08 7186.55 | 7186.55    1.6    999     0 |    0.45   3.25   0.04   0.00
2  1.21e+08 7186.55 | 7158.49    0.0    999     0 |    0.45   3.07   0.05   0.00
2  1.25e+08 7186.55 | 7171.98    0.0    999     0 |    0.45   2.93   0.06   0.00
2  1.29e+08 7265.19 |
2  1.29e+08 7265.19 | 7265.19    8.5    999     0 |    0.45   2.93   0.06   0.00
2  1.33e+08 7350.53 |
2  1.33e+08 7350.53 | 7350.53    0.5    999     0 |    0.46   2.97   0.08   0.00
2  1.36e+08 7350.53 | 7318.17    0.0    999     0 |    0.46   3.26   0.07   0.00
2  1.40e+08 7506.29 |
2  1.40e+08 7506.29 | 7506.29    3.5    999     0 |    0.46   3.10   0.07   0.00
2  1.44e+08 7506.29 | 7497.85    0.0    999     0 |    0.46   3.15   0.07   0.00
2  1.48e+08 7573.97 |
2  1.48e+08 7573.97 | 7573.97    6.9    999     0 |    0.46   3.62   0.02   0.00
2  1.52e+08 7573.97 | 7430.94    0.0    999     0 |    0.47   3.34   0.05   0.00
2  1.56e+08 7573.97 | 7472.38    0.0    999     0 |    0.47   3.51   0.06   0.00
2  1.59e+08 7619.16 |
2  1.59e+08 7619.16 | 7619.16    1.2    999     0 |    0.47   3.50   0.05   0.00
2  1.63e+08 7619.16 |  237.11    0.0    163     0 |    0.47   3.18   0.06   0.00
2  1.67e+08 7674.13 |
2  1.67e+08 7674.13 | 7674.13   41.4    999     0 |    0.48   3.42   0.04   0.00
2  1.71e+08 7683.78 |
2  1.71e+08 7683.78 | 7683.78   23.2    999     0 |    0.48   3.48   0.04   0.00
2  1.75e+08 7683.78 | 7674.56   96.3    999     0 |    0.48   3.67   0.04   0.00
2  1.78e+08 7786.97 |
2  1.78e+08 7786.97 | 7786.97    2.6    999     0 |    0.48   3.50   0.07   0.00
2  1.82e+08 7786.97 | 7771.78   18.5    999     0 |    0.48   3.54   0.05   0.00
2  1.86e+08 7786.97 | 4656.75    0.0    629     0 |    0.48   3.57   0.04   0.00
2  1.89e+08 7786.97 | 7743.48   80.1    999     0 |    0.49   3.59   0.04   0.00
2  1.93e+08 7924.90 |
2  1.93e+08 7924.90 | 7924.90   37.2    999     0 |    0.49   3.74   0.03   0.00
2  1.97e+08 7924.90 | 7903.48    0.0    999     0 |    0.49   3.74   0.04   0.00
2  2.00e+08 7925.32 |
2  2.00e+08 7925.32 | 7925.32    3.0    999     0 |    0.49   3.78   0.05   0.00
2  2.04e+08 7958.02 |
2  2.04e+08 7958.02 | 7958.02   70.6    999     0 |    0.49   3.67   0.04   0.00
2  2.08e+08 7958.02 | 7952.52    0.0    999     0 |    0.49   3.76   0.04   0.00
2  2.11e+08 7983.21 |
2  2.11e+08 7983.21 | 7983.21    3.9    999     0 |    0.49   3.81   0.04   0.00
2  2.15e+08 7983.21 | 7656.37    0.0    999     0 |    0.50   3.81   0.04   0.00
2  2.18e+08 8035.29 |
2  2.18e+08 8035.29 | 8035.29   30.9    999     0 |    0.50   3.66   0.05   0.00
2  2.22e+08 8035.29 | 7941.13    0.0    999     0 |    0.50   3.71   0.05   0.00
2  2.26e+08 8035.29 | 7798.48    0.0    999     0 |    0.50   3.92   0.06   0.00
2  2.30e+08 8035.29 | 7858.21    0.0    999     0 |    0.50   3.58   0.05   0.00
2  2.33e+08 8035.29 | 4127.11 3952.5    534   465 |    0.50   3.61   0.07   0.00
2  2.37e+08 8035.29 | 4088.30 3948.2    538   460 |    0.50   3.90   0.04   0.00
2  2.41e+08 8086.63 |
2  2.41e+08 8086.63 | 8086.63   48.4    999     0 |    0.50   3.82   0.05   0.00
2  2.44e+08 8098.47 |
2  2.44e+08 8098.47 | 8098.47   17.0    999     0 |    0.50   3.70   0.04   0.00
2  2.48e+08 8143.12 |
2  2.48e+08 8143.12 | 8143.12    2.3    999     0 |    0.50   3.82   0.07   0.00
2  2.52e+08 8143.12 |  219.54    0.0     67     0 |    0.50   4.01   0.04   0.00
2  2.56e+08 8143.12 | 8088.18    0.0    999     0 |    0.50   3.84   0.06   0.00
2  2.60e+08 8189.77 |
2  2.60e+08 8189.77 | 8189.77   18.9    999     0 |    0.51   3.80   0.06   0.00
2  2.64e+08 8189.77 | 8067.71    0.0    999     0 |    0.50   3.88   0.06   0.00
2  2.68e+08 8189.77 | 8182.07    0.0    999     0 |    0.51   3.79   0.05   0.00
2  2.72e+08 8189.77 | 8150.14    0.0    999     0 |    0.50   3.81   0.03   0.00
2  2.76e+08 8189.77 | 4163.22 4051.4    529   470 |    0.50   4.16   0.02   0.00
2  2.80e+08 8198.42 |
2  2.80e+08 8198.42 | 8198.42   56.4    999     0 |    0.50   3.99   0.05   0.00
2  2.83e+08 8198.42 | 8065.23    0.0    999     0 |    0.50   3.99   0.05   0.00
2  2.87e+08 8198.42 |  110.36    0.0     34     0 |    0.50   3.93   0.05   0.00
2  2.90e+08 8259.31 |
2  2.90e+08 8259.31 | 8259.31    8.7    999     0 |    0.50   3.77   0.08   0.00
2  2.93e+08 8259.31 | 8236.48   31.1    999     0 |    0.51   4.02   0.05   0.00
2  2.96e+08 8259.31 | 7924.47    0.0    999     0 |    0.50   3.89   0.05   0.00
2  3.00e+08 8289.48 |
2  3.00e+08 8289.48 | 8289.48   45.3    999     0 |    0.51   3.85   0.06   0.00
2  3.03e+08 8289.48 | 8197.63    0.0    999     0 |    0.51   3.96   0.04   0.00
2  3.06e+08 8289.48 | 8265.25   39.4    999     0 |    0.51   3.99   0.04   0.00
2  3.09e+08 8289.48 | 4253.46 4115.0    526   474 |    0.51   4.01   0.04   0.00
2  3.12e+08 8352.38 |
2  3.12e+08 8352.38 | 8352.38   13.4    999     0 |    0.51   4.07   0.03   0.00
2  3.16e+08 8352.38 | 8283.24    0.0    999     0 |    0.51   3.86   0.05   0.00
2  3.19e+08 8352.38 | 8314.57    0.0    999     0 |    0.51   3.86   0.05   0.00
2  3.22e+08 8352.38 | 8212.59    0.0    999     0 |    0.51   3.98   0.05   0.00
2  3.25e+08 8352.38 | 8090.58    0.0    999     0 |    0.51   3.96   0.05   0.00
2  3.28e+08 8352.38 | 8291.36    0.0    999     0 |    0.51   3.94   0.04   0.00
2  3.31e+08 8352.38 | 8330.48   86.4    999     0 |    0.51   4.18  -0.00   0.00
2  3.35e+08 8394.85 |
2  3.35e+08 8394.85 | 8394.85   21.4    999     0 |    0.51   3.84   0.05   0.00
2  3.38e+08 8394.85 | 8351.46    0.0    999     0 |    0.52   3.93   0.04   0.00
2  3.41e+08 8401.17 |
2  3.41e+08 8401.17 | 8401.17   98.3    999     0 |    0.51   4.31   0.02   0.00
2  3.44e+08 8401.17 | 8230.35    0.0    999     0 |    0.52   4.26   0.04   0.00
2  3.47e+08 8515.12 |
2  3.47e+08 8515.12 | 8515.12   34.2    999     0 |    0.52   4.27   0.04   0.00
2  3.50e+08 8515.12 | 8343.60    0.0    999     0 |    0.51   4.21   0.03   0.00
2  3.53e+08 8515.12 | 8418.96    0.0    999     0 |    0.51   3.99   0.05   0.00
2  3.56e+08 8515.12 | 8510.77    0.0    999     0 |    0.51   4.20   0.03   0.00
2  3.59e+08 8515.12 | 8442.03    0.0    999     0 |    0.52   3.95   0.07   0.00
2  3.63e+08 8515.12 | 8462.57    0.0    999     0 |    0.52   3.99   0.04   0.00
2  3.66e+08 8515.12 | 8427.00    0.0    999     0 |    0.52   4.05   0.04   0.00
2  3.70e+08 8515.12 | 8362.72    0.0    999     0 |    0.52   3.97   0.04   0.00
2  3.74e+08 8515.12 | 8201.42    0.0    999     0 |    0.52   4.03   0.05   0.00
2  3.77e+08 8515.12 | 8457.91    0.0    999     0 |    0.52   4.08   0.04   0.00
2  3.81e+08 8515.12 | 8499.09    0.0    999     0 |    0.52   3.99   0.05   0.00
2  3.85e+08 8515.12 | 4374.19 4199.9    534   466 |    0.52   4.06   0.05   0.00
2  3.89e+08 8609.47 |
2  3.89e+08 8609.47 | 8609.47   36.2    999     0 |    0.52   4.12   0.05   0.00
2  3.93e+08 8609.47 | 8410.42    0.0    999     0 |    0.52   4.11   0.02   0.00
2  3.97e+08 8609.47 | 8607.97   16.9    999     0 |    0.52   4.18   0.03   0.00
2  4.01e+08 8609.47 | 8582.87    0.0    999     0 |    0.52   4.08   0.04   0.00
2  4.04e+08 8609.47 | 8010.42    0.0    999     0 |    0.52   4.09   0.04   0.00
2  4.08e+08 8609.47 | 8512.01    0.0    999     0 |    0.52   4.35   0.04   0.00
2  4.12e+08 8654.72 |
2  4.12e+08 8654.72 | 8654.72   18.2    999     0 |    0.52   4.07   0.03   0.00
2  4.15e+08 8686.14 |
2  4.15e+08 8686.14 | 8686.14    1.1    999     0 |    0.52   4.19   0.05   0.00
2  4.19e+08 8686.14 | 8565.04    0.0    999     0 |    0.52   4.22   0.06   0.00
2  4.23e+08 8686.14 | 8605.58    0.0    999     0 |    0.52   4.18   0.05   0.00
2  4.26e+08 8686.14 | 8635.16    0.0    999     0 |    0.52   4.29   0.04   0.00
2  4.30e+08 8686.14 | 8480.89    0.0    999     0 |    0.52   4.02   0.04   0.00
2  4.34e+08 8686.14 | 8638.29   52.9    999     0 |    0.53   4.06   0.06   0.00
2  4.37e+08 8686.14 | 8400.74    0.0    999     0 |    0.53   4.25   0.04   0.00
2  4.41e+08 8686.14 | 8584.45    0.0    999     0 |    0.53   4.07   0.05   0.00
2  4.45e+08 8686.14 | 8676.59    0.0    999     0 |    0.53   3.98   0.06   0.00
2  4.48e+08 8686.14 | 8642.88    0.0    999     0 |    0.53   4.06   0.07   0.00
2  4.52e+08 8686.14 | 8503.15    0.0    999     0 |    0.53   4.23   0.04   0.00
2  4.55e+08 8686.43 |
2  4.55e+08 8686.43 | 8686.43   12.0    999     0 |    0.53   4.35   0.06   0.00
2  4.59e+08 8686.43 | 8560.22    0.0    999     0 |    0.53   4.32   0.05   0.00
2  4.63e+08 8686.43 | 8610.58    0.0    999     0 |    0.53   4.34   0.02   0.00
2  4.66e+08 8686.43 | 8261.38    0.0    999     0 |    0.52   4.23   0.04   0.00
2  4.70e+08 8686.43 | 4696.17 4022.1    569   430 |    0.53   4.31   0.03   0.00
2  4.74e+08 8686.43 | 8582.68    0.0    999     0 |    0.53   4.46   0.03   0.00
2  4.77e+08 8686.43 | 8607.55    0.0    999     0 |    0.53   4.31   0.06   0.00
2  4.81e+08 8686.43 | 8650.08    0.0    999     0 |    0.53   4.19   0.05   0.00
2  4.85e+08 8686.43 | 8538.61    0.0    999     0 |    0.53   4.17   0.05   0.00
2  4.89e+08 8686.43 | 8629.97    0.0    999     0 |    0.53   4.09   0.05   0.00
2  4.92e+08 8715.26 |
2  4.92e+08 8715.26 | 8715.26   12.1    999     0 |    0.53   4.30   0.06   0.00
2  4.96e+08 8715.26 | 8564.10    0.0    999     0 |    0.53   4.15   0.07   0.00
2  5.00e+08 8715.26 | 8605.58    0.0    999     0 |    0.53   4.41   0.03   0.00
2  5.03e+08 8715.26 | 8520.82    0.0    999     0 |    0.53   4.18   0.04   0.00
2  5.07e+08 8715.26 | 8567.60    0.0    999     0 |    0.53   4.29   0.04   0.00
2  5.11e+08 8715.26 | 8435.14    0.0    999     0 |    0.53   4.11   0.03   0.00
2  5.14e+08 8715.26 | 8678.62    0.0    999     0 |    0.53   4.21   0.05   0.00
2  5.18e+08 8715.26 | 8688.30    0.0    999     0 |    0.53   4.59   0.03   0.00
2  5.22e+08 8715.26 | 8625.63    0.0    999     0 |    0.53   4.58   0.06   0.00
| UsedTime:   76729 | SavedDir: ./Humanoid_PPO_2
        """
    elif env_name == 'Humanoid.8168':
        env_func = IsaacVecEnv
        env_args = {
            'env_num': 1024,
            'env_name': 'Humanoid',
            'max_step': 1000,
            'state_dim': 108,
            'action_dim': 21,
            'if_discrete': False,
            'target_return': 15000.,

            'sim_device_id': gpu_id,
            'rl_device_id': gpu_id,
        }
        args = Arguments(agent_class, env_func=env_func, env_args=env_args)
        args.eval_env_func = IsaacOneEnv
        args.eval_env_args = {
            'env_num': 1,
            'env_name': 'Humanoid',
            'max_step': 1000,
            'state_dim': 108,
            'action_dim': 21,
            'if_discrete': False,
            'target_return': 15000.,

            'device_id': gpu_id,
        }

        args.reward_scale = 2 ** -4
        args.if_cri_target = False

        args.repeat_times = 2 ** 4
        args.gamma = 0.985
        args.if_use_gae = True
        args.learning_rate = 2 ** -15

        args.target_step = args.max_step
        args.batch_size = args.net_dim * 4
        args.worker_num = 1
        args.if_use_old_traj = False

        args.net_dim = 2 ** 8
        args.batch_size = args.net_dim * 4
        args.repeat_times = 2 ** 4
        args.lambda_gae_adv = 0.85
        args.learning_rate = 2 ** -15

        args.lambda_entropy = 2 ** -6

        args.eval_gap = 2 ** 9
        args.eval_times = 2 ** 1
        args.max_step = int(6e7)

        """
################################################################################
ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
[Error] [carb.windowing-glfw.plugin] GLFW initialization failed.
[Error] [carb.windowing-glfw.plugin] GLFW window creation failed!
[Error] [carb.gym.plugin] Failed to create Window in CreateGymViewerInternal
3  2.02e+06   79.98 |
3  2.02e+06   79.98 |   79.98   16.0     37     3 |    0.14   0.22   0.09   0.00
3  6.04e+06  114.76 |
3  6.04e+06  114.76 |  114.76    5.9     48     2 |    0.15   0.23   0.10   0.00
3  1.00e+07  114.76 |  109.01    0.0     55     0 |    0.16   0.18   0.05   0.00
3  1.40e+07  158.16 |
3  1.40e+07  158.16 |  158.16    8.7     58    13 |    0.17   0.17   0.08   0.00
3  1.80e+07  158.16 |  154.98   13.5     54    14 |    0.18   0.13   0.01   0.00
3  2.19e+07  206.19 |
3  2.19e+07  206.19 |  206.19   23.6     61     7 |    0.19   0.15  -0.00   0.00
3  2.59e+07  206.19 |  192.67    0.0     56     0 |    0.19   0.15   0.00   0.00
3  2.99e+07  299.62 |
3  2.99e+07  299.62 |  299.62   19.0    113     2 |    0.20   0.18   0.00   0.00
3  3.38e+07  476.75 |
3  3.38e+07  476.75 |  476.75  103.1    154    31 |    0.20   0.32   0.01   0.00
3  3.77e+07  511.60 |
3  3.77e+07  511.60 |  511.60    5.6    167    16 |    0.20   0.45   0.00   0.00
3  4.15e+07 1303.89 |
3  4.15e+07 1303.89 | 1303.89  265.4    416   100 |    0.21   0.56  -0.01   0.00
3  4.52e+07 3275.81 |
3  4.52e+07 3275.81 | 3275.81   27.8    999     0 |    0.21   0.73   0.02   0.00
3  4.86e+07 3364.63 |
3  4.86e+07 3364.63 | 3364.63    0.4    999     0 |    0.22   0.77  -0.02   0.00

3  5.21e+07 3606.62 |
3  5.21e+07 3606.62 | 3606.62    2.3    999     0 |    0.23   1.01   0.06   0.00
3  5.56e+07 3900.77 |
3  5.56e+07 3900.77 | 3900.77   16.4    999     0 |    0.24   1.39  -0.00   0.00
3  5.88e+07 4170.07 |
3  5.88e+07 4170.07 | 4170.07   14.7    999     0 |    0.26   1.68   0.04   0.00
3  6.21e+07 4499.06 |
3  6.21e+07 4499.06 | 4499.06    3.0    999     0 |    0.27   1.82   0.05   0.00
3  6.54e+07 4785.18 |
3  6.54e+07 4785.18 | 4785.18   10.3    999     0 |    0.29   1.91   0.00   0.00
3  6.86e+07 5007.28 |
3  6.86e+07 5007.28 | 5007.28   12.8    999     0 |    0.30   2.02   0.01   0.00
3  7.18e+07 5145.29 |
3  7.18e+07 5145.29 | 5145.29   32.6    999     0 |    0.31   2.12   0.04   0.00
3  7.49e+07 5300.70 |
3  7.49e+07 5300.70 | 5300.70    7.0    999     0 |    0.32   2.19   0.03   0.00
3  7.81e+07 5387.67 |
3  7.81e+07 5387.67 | 5387.67    2.3    999     0 |    0.32   2.10   0.02   0.00
3  8.13e+07 5439.57 |
3  8.13e+07 5439.57 | 5439.57   24.0    999     0 |    0.33   2.36   0.01   0.00
3  8.44e+07 5584.72 |
3  8.44e+07 5584.72 | 5584.72   20.7    999     0 |    0.34   2.32   0.01   0.00
3  8.75e+07 5722.92 |
3  8.75e+07 5722.92 | 5722.92    5.4    999     0 |    0.35   2.28   0.01   0.00
3  9.10e+07 5830.65 |
3  9.10e+07 5830.65 | 5830.65   21.9    999     0 |    0.36   2.65   0.00   0.00
3  9.45e+07 5973.10 |
3  9.45e+07 5973.10 | 5973.10    7.6    999     0 |    0.37   2.54  -0.01   0.00
3  9.79e+07 6155.93 |
3  9.79e+07 6155.93 | 6155.93   26.2    999     0 |    0.37   2.65   0.04   0.00
3  1.01e+08 6220.14 |
3  1.01e+08 6220.14 | 6220.14   41.9    999     0 |    0.38   2.51   0.04   0.00
3  1.05e+08 6336.25 |
3  1.05e+08 6336.25 | 6336.25   29.7    999     0 |    0.39   2.56   0.03   0.00
3  1.08e+08 6392.16 |
3  1.08e+08 6392.16 | 6392.16    3.7    999     0 |    0.39   2.78   0.00   0.00
3  1.12e+08 6392.16 | 6348.32    0.0    999     0 |    0.40   2.85   0.02   0.00
3  1.15e+08 6392.16 | 5429.28 1177.1    832   166 |    0.40   2.79   0.03   0.00
3  1.19e+08 6670.74 |
3  1.19e+08 6670.74 | 6670.74   19.2    999     0 |    0.41   2.66   0.03   0.00
3  1.22e+08 6743.09 |
3  1.22e+08 6743.09 | 6743.09   53.1    999     0 |    0.41   3.01   0.01   0.00
3  1.25e+08 6746.77 |
3  1.25e+08 6746.77 | 6746.77    1.4    999     0 |    0.41   2.99   0.05   0.00
3  1.29e+08 6806.96 |
3  1.29e+08 6806.96 | 6806.96   15.9    999     0 |    0.42   3.04   0.05   0.00
3  1.32e+08 6897.12 |
3  1.32e+08 6897.12 | 6897.12   27.3    999     0 |    0.42   2.80   0.04   0.00
3  1.35e+08 6897.12 | 6845.48    0.0    999     0 |    0.42   2.86   0.01   0.00
3  1.39e+08 6932.83 |
3  1.39e+08 6932.83 | 6932.83   21.3    999     0 |    0.43   3.03   0.04   0.00
3  1.42e+08 6932.83 | 6866.63    0.0    999     0 |    0.43   3.60  -0.05   0.00
3  1.46e+08 6944.93 |
3  1.46e+08 6944.93 | 6944.93   11.7    999     0 |    0.43   3.24   0.01   0.00
3  1.49e+08 7016.51 |
3  1.49e+08 7016.51 | 7016.51    9.6    999     0 |    0.44   2.86   0.05   0.00
3  1.52e+08 7067.84 |
3  1.52e+08 7067.84 | 7067.84    1.3    999     0 |    0.44   3.14  -0.00   0.00
3  1.56e+08 7067.84 | 7003.16    0.0    999     0 |    0.44   2.96   0.07   0.00
3  1.59e+08 7129.56 |
3  1.59e+08 7129.56 | 7129.56    7.9    999     0 |    0.44   3.30   0.02   0.00
3  1.62e+08 7150.48 |
3  1.62e+08 7150.48 | 7150.48    3.7    999     0 |    0.45   3.43  -0.01   0.00
3  1.66e+08 7150.48 | 7147.57   38.8    999     0 |    0.45   3.44  -0.00   0.00
3  1.69e+08 7222.12 |
3  1.69e+08 7222.12 | 7222.12   11.4    999     0 |    0.45   3.29   0.02   0.00
3  1.72e+08 7222.12 | 7190.09    0.0    999     0 |    0.45   3.46  -0.02   0.00
3  1.76e+08 7322.86 |
3  1.76e+08 7322.86 | 7322.86    4.1    999     0 |    0.45   3.29   0.04   0.00
3  1.79e+08 7322.86 | 7314.01    0.0    999     0 |    0.46   3.15   0.04   0.00
3  1.82e+08 7322.86 | 7307.63   34.4    999     0 |    0.46   2.98   0.04   0.00
3  1.86e+08 7368.63 |
3  1.86e+08 7368.63 | 7368.63    6.3    999     0 |    0.46   2.89   0.06   0.00
3  1.89e+08 7396.53 |
3  1.89e+08 7396.53 | 7396.53   17.5    999     0 |    0.46   3.22   0.05   0.00
3  1.92e+08 7396.53 | 7375.49    0.0    999     0 |    0.46   3.48  -0.00   0.00
3  1.96e+08 7429.27 |
3  1.96e+08 7429.27 | 7429.27   27.1    999     0 |    0.46   3.11   0.04   0.00
3  1.99e+08 7429.27 | 7385.12    0.0    999     0 |    0.46   3.33   0.05   0.00
3  2.02e+08 7429.27 | 7426.69    7.1    999     0 |    0.46   3.19   0.05   0.00
3  2.06e+08 7429.39 |
3  2.06e+08 7429.39 | 7429.39   22.6    999     0 |    0.47   2.89   0.06   0.00
3  2.09e+08 7469.16 |
3  2.09e+08 7469.16 | 7469.16   22.3    999     0 |    0.47   3.17  -0.00   0.00
3  2.12e+08 7469.16 | 7445.96    0.0    999     0 |    0.47   3.66  -0.01   0.00
3  2.16e+08 7485.55 |
3  2.16e+08 7485.55 | 7485.55   80.2    999     0 |    0.47   3.30   0.03   0.00
3  2.19e+08 7485.55 | 7454.81    0.0    999     0 |    0.47   3.27   0.05   0.00
3  2.22e+08 7485.55 | 7459.73   92.0    999     0 |    0.47   3.55  -0.01   0.00
3  2.25e+08 7612.16 |
3  2.25e+08 7612.16 | 7612.16   49.4    999     0 |    0.47   3.34   0.04   0.00
3  2.29e+08 7647.53 |
3  2.29e+08 7647.53 | 7647.53   10.2    999     0 |    0.47   3.67  -0.02   0.00
3  2.32e+08 7659.38 |
3  2.32e+08 7659.38 | 7659.38   31.3    999     0 |    0.48   3.11   0.07   0.00
3  2.35e+08 7684.98 |
3  2.35e+08 7684.98 | 7684.98   29.2    999     0 |    0.48   3.43   0.01   0.00
3  2.38e+08 7695.20 |
3  2.38e+08 7695.20 | 7695.20    9.3    999     0 |    0.48   3.31   0.04   0.00
3  2.41e+08 7716.73 |
3  2.41e+08 7716.73 | 7716.73   12.2    999     0 |    0.48   3.35   0.02   0.00
3  2.45e+08 7730.91 |
3  2.45e+08 7730.91 | 7730.91    3.0    999     0 |    0.48   3.51  -0.01   0.00
3  2.48e+08 7730.91 | 7720.90    0.0    999     0 |    0.48   3.29   0.03   0.00
3  2.51e+08 7751.88 |
3  2.51e+08 7751.88 | 7751.88    6.1    999     0 |    0.48   3.33   0.00   0.00
3  2.55e+08 7788.04 |
3  2.55e+08 7788.04 | 7788.04   10.6    999     0 |    0.48   3.22   0.06   0.00
3  2.58e+08 7788.04 | 7784.09    0.0    999     0 |    0.49   3.63  -0.01   0.00
3  2.61e+08 7788.04 | 7766.73   64.4    999     0 |    0.49   3.28   0.04   0.00
3  2.64e+08 7808.78 |
3  2.64e+08 7808.78 | 7808.78    3.8    999     0 |    0.49   3.58   0.05   0.00
3  2.68e+08 7808.78 | 7792.78   25.9    999     0 |    0.49   3.21   0.01   0.00
3  2.71e+08 7808.78 | 7804.41    0.0    999     0 |    0.49   3.25   0.04   0.00
3  2.74e+08 7827.40 |
3  2.74e+08 7827.40 | 7827.40   58.4    999     0 |    0.49   3.93  -0.02   0.00
3  2.78e+08 7893.99 |
3  2.78e+08 7893.99 | 7893.99    1.9    999     0 |    0.49   3.67   0.02   0.00
3  2.81e+08 7893.99 | 7846.65    0.0    999     0 |    0.49   3.42   0.02   0.00
3  2.84e+08 7893.99 | 7821.12    0.0    999     0 |    0.49   3.78  -0.04   0.00
3  2.88e+08 7893.99 | 7855.05    0.0    999     0 |    0.49   3.57   0.04   0.00
3  2.91e+08 7893.99 | 7825.09    0.0    999     0 |    0.49   3.41   0.03   0.00
3  2.93e+08 7893.99 | 7879.51    0.0    999     0 |    0.49   3.31   0.02   0.00
3  2.96e+08 7893.99 | 7823.53    0.0    999     0 |    0.49   3.47   0.07   0.00
3  2.99e+08 7893.99 | 7878.77   37.2    999     0 |    0.49   3.68  -0.04   0.00
3  3.02e+08 7893.99 | 7827.60    0.0    999     0 |    0.49   3.52   0.03   0.00
3  3.05e+08 7893.99 | 7712.52    0.0    999     0 |    0.50   3.44   0.02   0.00
3  3.08e+08 7930.73 |
3  3.08e+08 7930.73 | 7930.73   23.6    999     0 |    0.50   3.68   0.02   0.00
3  3.11e+08 7930.73 | 7904.09   60.4    999     0 |    0.50   3.42   0.02   0.00
3  3.13e+08 7930.73 | 7923.25    0.0    999     0 |    0.50   3.72   0.02   0.00
3  3.16e+08 7968.25 |
3  3.16e+08 7968.25 | 7968.25   13.7    999     0 |    0.50   3.43   0.01   0.00
3  3.19e+08 7968.25 | 7915.60    0.0    999     0 |    0.50   3.58   0.02   0.00
3  3.22e+08 7968.25 | 7966.22    0.0    999     0 |    0.50   3.92   0.03   0.00
3  3.25e+08 7968.25 | 7945.57   50.4    999     0 |    0.50   3.25   0.04   0.00
3  3.28e+08 7970.02 |
3  3.28e+08 7970.02 | 7970.02   74.7    999     0 |    0.50   3.72   0.01   0.00
3  3.31e+08 8040.09 |
3  3.31e+08 8040.09 | 8040.09    3.2    999     0 |    0.50   3.65   0.05   0.00
3  3.34e+08 8040.87 |
3  3.34e+08 8040.87 | 8040.87    8.2    999     0 |    0.50   3.43   0.06   0.00
3  3.36e+08 8062.93 |
3  3.36e+08 8062.93 | 8062.93   16.6    999     0 |    0.50   3.43   0.04   0.00
3  3.39e+08 8078.66 |
3  3.39e+08 8078.66 | 8078.66    0.9    999     0 |    0.50   3.47   0.06   0.00
3  3.42e+08 8078.66 | 8044.82    0.0    999     0 |    0.50   3.22   0.06   0.00
3  3.45e+08 8078.66 | 8022.24    0.0    999     0 |    0.50   3.49   0.02   0.00
3  3.48e+08 8078.66 | 8058.88   26.3    999     0 |    0.50   3.43   0.02   0.00
3  3.51e+08 8078.66 | 7974.26  108.1    999     0 |    0.51   3.41   0.06   0.00
3  3.54e+08 8083.05 |
3  3.54e+08 8083.05 | 8083.05   24.0    999     0 |    0.51   3.58   0.04   0.00
3  3.57e+08 8083.05 | 8063.05    0.0    999     0 |    0.51   3.28   0.04   0.00
3  3.60e+08 8083.05 | 7990.97  109.2    999     0 |    0.51   3.55   0.03   0.00
3  3.64e+08 8122.19 |
3  3.64e+08 8122.19 | 8122.19    8.8    999     0 |    0.51   3.71   0.03   0.00
3  3.67e+08 8122.19 | 8104.86    0.0    999     0 |    0.51   3.71   0.04   0.00
3  3.70e+08 8122.19 | 7934.19    0.0    999     0 |    0.51   3.85   0.03   0.00
3  3.73e+08 8122.19 | 8114.94   51.4    999     0 |    0.51   3.58   0.03   0.00
3  3.76e+08 8128.53 |
3  3.76e+08 8128.53 | 8128.53   16.7    999     0 |    0.51   3.66   0.04   0.00
3  3.80e+08 8168.30 |
3  3.80e+08 8168.30 | 8168.30   11.5    999     0 |    0.51   3.92   0.02   0.00
3  3.83e+08 8168.30 | 8136.32    0.0    999     0 |    0.51   3.72   0.04   0.00
3  3.86e+08 8168.30 | 8103.20    0.0    999     0 |    0.51   3.47   0.05   0.00
3  3.89e+08 8168.30 | 8160.08    0.0    999     0 |    0.51   3.72   0.05   0.00
| UsedTime:   67227 | SavedDir: ./Humanoid_PPO_3
| Learner: Save in ./Humanoid_PPO_3
        """
    elif env_name == 'ShadowHand':
        env_func = IsaacVecEnv
        env_num = 512

        env_args = {
            'env_num': env_num,
            'env_name': env_name,
            'max_step': 600,
            'state_dim': 211,
            'action_dim': 20,
            'if_discrete': False,
            'target_return': 15000.,

            'sim_device_id': gpu_id,
            'rl_device_id': gpu_id,
        }
        args = Arguments(agent_class, env_func=env_func, env_args=env_args)
        args.eval_env_func = IsaacOneEnv
        args.eval_env_args = {
            'env_num': 1,
            'env_name': env_name,
            'max_step': 600,
            'state_dim': 211,
            'action_dim': 20,
            'if_discrete': False,
            'target_return': 15000.,

            'device_id': gpu_id,
        }

        args.reward_scale = 2 ** 0

        args.net_dim = 2 ** 9
        args.num_layer = 3
        args.batch_size = args.net_dim
        args.target_step = args.max_step
        args.max_memo = env_num * args.max_step * 4

        args.repeat_times = 2 ** -3
        args.gamma = 0.99
        args.learning_rate = 2 ** -15

        args.worker_num = 1
        args.if_act_target = False

        args.eval_gap = 2 ** 8
        args.eval_times = 2 ** 1
        args.max_step = int(2e8)
    else:
        raise ValueError('env_name:', env_name)

    args.learner_gpus = gpu_id
    args.random_seed += gpu_id + 123
    
    cwd = f'{args.env_name}_{args.agent.__name__[5:]}_{args.learner_gpus}'
    wandb.init(
        project=cwd,
        entity=None,
        sync_tensorboard=True,
        config=vars(args),
        name=cwd,
        monitor_gym=True,
        save_code=True,
    )
    
    if_check = 0
    if if_check:
        train_and_evaluate(args)
    else:
        train_and_evaluate_mp(args)

  
if __name__ == '__main__':
    GPU_ID = int(sys.argv[1]) if len(sys.argv) > 1 else 0  # >=0 means GPU ID, -1 means CPU
    DRL_ID = int(sys.argv[2]) if len(sys.argv) > 2 else 0
    ENV_ID = int(sys.argv[3]) if len(sys.argv) > 3 else 1

    # demo_sac(GPU_ID, DRL_ID, ENV_ID)
    demo_ppo(GPU_ID, DRL_ID, ENV_ID)

    # from elegantrl.envs.IsaacGym import check_isaac_gym
    #
    # print('int(sys.argv[1])', sys.argv[1])
    # print('int(sys.argv[2])', sys.argv[2])
    # check_isaac_gym(gpu_id=int(sys.argv[1]), env_name=str(sys.argv[2]))
